"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_copilot-chat_components_ChatInput_tsx-ui_packages_copilot-chat_components_LegalDi-cbec1d"],{69425:(e,t,n)=>{n.d(t,{g:()=>a});var r=n(96540);function a(e){let[t,n]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let t=e.current,r=t?.lastElementChild;if(!r)return;let a=new IntersectionObserver(([e])=>n(e?.isIntersecting??!0),{root:t,threshold:1});return a.observe(r),()=>a.disconnect()}),t}},91189:(e,t,n)=>{n.d(t,{U:()=>c});var r=n(62562),a=n(10833),i=n(96540),s=n(18312),o=n(65615),l=n(7426);function c(e,t,n,c,u,m){let{topRepositoriesCache:p}=(0,o.Pk)(),h=(0,l.b)(),[f,g]=(0,i.useState)([]),[x,y]=(0,i.useState)(!p),v=(0,i.useRef)(void 0),b=(0,s.useRelayEnvironment)(),j=(0,s.useFragment)(a.Sy,t??null);if(j&&!p&&!e){let{topRepositories:e}=j,t=d((e.edges||[]).flatMap(e=>e?.node?[(0,s.readInlineData)(a.R6,e.node)]:[])),{ownerLogin:r,name:i}=u??{};u&&!t.find(e=>`${e.ownerLogin}/${e.name}`==`${r}/${i}`)&&t.splice(0,0,{databaseId:u.id,isInOrganization:"Organization"===u.ownerType,name:u.name,nwo:`${u.ownerLogin}/${u.name}`,ownerLogin:u.ownerLogin,ownerAvatarUrl:`/${u.ownerLogin}.png?s=40`}),setTimeout(()=>h.setTopRepositoryTopics(t),10),y(!1),n(void 0)}let w=(0,i.useCallback)(async()=>{try{let e=await (0,s.fetchQuery)(b,a.m,{topRepositoriesFirst:m}).toPromise();n(e?.viewer)}catch{}finally{y(!1)}},[b,n,m]);return((0,i.useEffect)(()=>{c&&w()},[w,c]),(0,i.useEffect)(()=>{let t=async e=>{y(!0);let t=((await new Promise((t,n)=>{(0,s.fetchQuery)(b,a.XD,{searchQuery:(0,r.J)(e)}).subscribe({start:e=>{v.current?.unsubscribe(),v.current=e},next:e=>{t(e)},error:e=>{n(e)}})})).search.nodes||[]).flatMap(e=>e?[(0,s.readInlineData)(a.R6,e)]:[]);g(t.length?d(t):[]),y(!1)};e?t(e):p&&g(p)},[e,b,p]),p&&!e)?{repositories:p,loading:!1}:{repositories:f,loading:x}}function d(e){return e.map(({owner:{login:e,avatarUrl:t},isInOrganization:n,name:r,databaseId:a})=>({databaseId:a??0,isInOrganization:n,name:r,nwo:`${e}/${r}`,ownerLogin:e,ownerAvatarUrl:t}))}},21057:(e,t,n)=>{n.d(t,{JE:()=>m,Z3:()=>u,bn:()=>d,kw:()=>p});var r=n(97286),a=n(80758),i=n(96540),s=n(82610),o=n(65615),l=n(7426),c=n(68956);let d="https://github.com/marketplace?type=apps&copilot_app=true",u="@";function m(e=!0){let t=(0,o.Pk)(),n=(0,l.b)(),a=(0,c.iI)(),d=n.getSelectedThread(t)?.customCopilotID,u=!!(a||d),{model:p,messages:h,agentsPath:f}=t,g=p?.hasLimitedCapabilities,x=(0,i.useCallback)(e=>{if(g||u)return{agents:[],showLimit:!1};let t=(0,s.Q7)(h)[0];return t?{agents:e.filter(e=>e.slug===t.name),showLimit:!0}:{agents:e,showLimit:!1}},[u,h,g]),{isLoading:y,data:v,refetch:b,isStale:j,isFetched:w}=(0,r.I)({queryKey:["copilot-chat","agents",f],queryFn:()=>f?n.fetchAgents(f):[],select:x,enabled:e&&!g&&!u}),I=async()=>!w||j?(await b()).data:v;return{loading:y,disabled:g,availableAgents:v?.agents,showLimit:v?.showLimit??!1,imperativelyFetch:I}}function p({inputOnChange:e,inputRef:t}){let n=(0,a.H)({inputRef:t,fallbackEventHandler:e});return(0,i.useCallback)((e="")=>{t.current?.value&&n(" ",[0,0]);let r=`${u}${e}`;n(r,[0,0],r.length)},[n,t])}},10967:(e,t,n)=>{n.d(t,{Ld:()=>h,M8:()=>g,Tz:()=>v,U2:()=>f,W5:()=>d,cx:()=>p,r_:()=>y,vn:()=>x,xG:()=>u});var r=n(97665),a=n(40458),i=n(94747),s=n(97286),o=n(57572),l=n(96540),c=n(37937);n(65615),n(7426);let d={Unindexed:"not_indexed",Indexed:"indexed",Indexing:"indexing",PartiallyIndexed:"partially_indexed",Unknown:"unknown"},u={Requested:"requested",NotFound:"not_found",Unauthorized:"unauthorized",ServiceUnavailable:"service_unavailable",QuotaExhausted:"quota_exhausted",Forbidden:"forbidden",CanIndex:"ok",IndexingError:"indexing_error",RequestFailed:"request_failed",Unknown:"unknown"},m=[u.NotFound,u.Unauthorized,u.ServiceUnavailable,u.QuotaExhausted,u.Forbidden,u.RequestFailed],p=256,h=400;function f(e,t,n){let r=(0,l.useRef)(void 0),a=(0,l.useRef)(void 0),i=(0,l.useRef)([]),s=(0,l.useRef)(!1),[o,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(!0),m=(0,l.useCallback)(()=>{c([]),u(!1)},[]),p=(0,l.useCallback)(()=>{if(n&&e)try{let e=new Worker(n);e.onmessage=({data:e})=>{s.current=!1,c(e.list),u(!1),a.current=e.query,i.current=e.list},r.current=e}catch(e){console.warn("Web workers are not available: ",e)}},[n,e]),h=(0,l.useCallback)(t=>{s.current&&(r.current?.terminate(),p());let n=a.current&&t.startsWith(a.current)&&i.current.length;u(!0),s.current=!0,r.current?.postMessage({baseList:n?i.current:e,query:t})},[e,p]);return((0,l.useEffect)(()=>(p(),()=>r.current?.terminate()),[p]),(0,l.useEffect)(()=>{h(t)},[t,h]),n)?[o,d,m]:[[],!1,()=>{}]}function g(e){var t,n;let s=(0,r.jE)(),o=(0,l.useCallback)(()=>Promise.all(e.map(e=>s.invalidateQueries({queryKey:["copilot-chat","repos-indexing-state",e]}))),[s,e]),c=(0,a.E)({queries:e.map(e=>({queryKey:["copilot-chat","repos-indexing-state",e],queryFn:()=>b(e),placeholderData:{requestStatus:u.Unknown,code:d.Unknown,docs:d.Unknown},staleTime:1/0}))}),{mutate:p}=(0,i.n)({mutationKey:["repos-indexing-state"],mutationFn:()=>j(e),onSuccess:o}),h={requestStatus:0===(n=(t=c.map(e=>e.data)).map(e=>e.requestStatus)).length?u.Unknown:n.some(e=>m.includes(e))?u.IndexingError:n.every(e=>e===u.CanIndex)?u.CanIndex:(n.every(e=>e===u.Unknown),u.Unknown),code:I(t.map(e=>e.code)),docs:I(t.map(e=>e.docs)),remainingRepoIndexTokens:t[0]?.remainingRepoIndexTokens};return R(()=>void o(),h.code===d.Indexing&&h.requestStatus!==u.IndexingError?1e4:0),[h,()=>p()]}function x(e){let t=(0,r.jE)(),n=(0,l.useCallback)(()=>Promise.resolve(t.invalidateQueries({queryKey:["repo-indexing-state",e]})),[t,e]),a=(0,s.I)({queryKey:["copilot-chat","repo-indexing-state",e],queryFn:()=>b(e),placeholderData:{requestStatus:u.Unknown,code:d.Unknown,docs:d.Unknown},staleTime:1/0}),{mutate:o}=(0,i.n)({mutationKey:["repo-indexing-state"],mutationFn:()=>j([e]),onSuccess:n}),c=a.data;return R(()=>void n(),c.code===d.Indexing&&c.requestStatus!==u.IndexingError?1e4:0),[c,()=>o()]}function y(e){let t=(0,s.I)({queryKey:["copilot-chat","repos-indexing-state",e],queryFn:()=>w(e),staleTime:1/0});return!t.isError&&!!t.data?.canChat}function v(){let e=c.J.getPanelHeight(),t=c.J.getPanelWidth(),n=(0,l.useRef)(null),r=(0,l.useRef)(e),a=(0,l.useRef)(e),i=(0,l.useRef)(null),s=(0,l.useRef)(t),o=(0,l.useRef)(t),[d,u]=(0,l.useState)(e),[m,f]=(0,l.useState)(t),g=(0,l.useRef)(0);(0,l.useEffect)(()=>{g.current=parseFloat(getComputedStyle(document.documentElement).fontSize)},[]);let x=e=>Math.min(Math.max(e,p),window.innerHeight-g.current),y=e=>Math.min(Math.max(e,h),window.innerWidth-2*g.current),v=(0,l.useCallback)(e=>{if(null!==n.current){let t=n.current-e.clientY,i=x(r.current+t);u(i),a.current=i}if(null!==i.current){let t=i.current-e.clientX,n=y(s.current+t);f(n),o.current=n}},[]),b=(0,l.useCallback)(()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",b),null!==n.current&&(c.J.setPanelHeight(a.current),n.current=null),null!==i.current&&(c.J.setPanelWidth(o.current),i.current=null)},[v]),j=(0,l.useCallback)((e,t,a)=>{0===e.button&&(e.preventDefault(),a&&(n.current=e.clientY,r.current=d),t&&(i.current=e.clientX,s.current=m),window.addEventListener("mousemove",v),window.addEventListener("mouseup",b))},[d,m,v,b]),w=(0,l.useCallback)(e=>{if("ArrowUp"===e.key){let t=x(d+4);u(t),c.J.setPanelHeight(t),e.preventDefault()}else if("ArrowDown"===e.key){let t=x(d-4);u(t),c.J.setPanelHeight(t),e.preventDefault()}else if("ArrowRight"===e.key){let t=y(m-4);f(t),c.J.setPanelWidth(t),e.preventDefault()}else if("ArrowLeft"===e.key){let t=y(m+4);f(t),c.J.setPanelWidth(t),e.preventDefault()}},[d,m]);return{panelWidth:m,panelHeight:d,startResize:j,onResizerKeyDown:w}}async function b(e){let t=await fetch(`/search/check_indexing_status?nwo=${encodeURIComponent(e)}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!t.ok)return{requestStatus:u.RequestFailed,code:d.Unknown,docs:d.Unknown};let n=await t.json();return{requestStatus:n.can_index,code:n.code_status,docs:n.docs_status}}async function j(e){let t=1===e.length?`nwo=${encodeURIComponent(e[0])}`:`nwos=${encodeURIComponent(JSON.stringify(e))}`;return(0,o.DI)(`/search/index_embeddings?${t}&index_code=true`,{method:"POST"})}async function w(e){let t=await fetch(`/github-copilot/docs/docsets/kb_indexed_repos?ids=${encodeURIComponent(JSON.stringify(e))}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});return t.ok?await t.json():{canChat:!1}}function I(e){return e.every(e=>e===d.Indexed)?d.Indexed:e.every(e=>e===d.Unindexed)?d.Unindexed:e.some(e=>e===d.Indexing)?d.Indexing:e.some(e=>e===d.Unindexed)?d.PartiallyIndexed:d.Unknown}function R(e,t){let n=(0,l.useRef)(void 0),r=(0,l.useRef)(e);return(0,l.useEffect)(()=>{r.current=e},[e]),(0,l.useEffect)(()=>{if(t>0)return n.current=window.setInterval(()=>r.current(),t),()=>window.clearInterval(n.current)},[t]),n}},39046:(e,t,n)=>{n.d(t,{s:()=>CopilotImageAttacher});var r=n(46988),a=n(2622),i=n(5271),s=n(31747);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let l=["image/gif","image/jpeg","image/png","image/webp"];let CopilotImageAttacher=class CopilotImageAttacher{static getAllowedImageFileExtensions(e){return this.getFileExtensions(e).join(",")}static isTypeAllowed(e,t){return e=e.toLowerCase(),this.getMimeTypes(t).includes(e)}static getAttachmentLimit(){return 1}static getAttachmentSizeLimit(){return a.W.dotcomChatFileUpload?384e4:512e3}static makeImageReference(e,t){let n;let r=crypto.randomUUID();return a.W.dotcomChatFileUpload&&(n=new s.N(r,e,t)),n||(n=new s.J(r,e)),{id:r,attachment:n,type:"image",name:e.name||"Image"}}static getFileExtensions(e){let t=this.getMimeTypes(e).map(e=>`.${e.split("/")[1]}`);return t.includes(".jpeg")&&t.push(".jpg"),t}static getMimeTypes(e){return e.capabilities.limits.vision?e.capabilities.limits.vision.supported_media_types.filter(e=>l.includes(e)):[]}async addImageAttachment(e,t="unknown"){let n=this.state.selectedThreadID;if(!n&&a.W.dotcomChatFileUpload)try{n=(await this.manager.createThread()).id}catch(t){let e="An error occurred creating the thread. Sending a single message should create a new thread.";throw t instanceof Error&&(e||(e=t.message)),this.manager.addAmbientError(e),Error(e)}if(this.state.currentReferences.find(e=>"image"===e.type)){this.manager.addAmbientError("Only one image can be uploaded at a time"),(0,i.d)("file_limit_reached");return}if(("menu"===t||"unknown"===t)&&!CopilotImageAttacher.isTypeAllowed(e.type,this.state.model)){(0,i.d)("included_unsupported_file",{fileTypes:e.type,uploadType:t});return}let s=a.W.dotcomChatFileUpload,o=`Only images below ${s?"3.75MB":"500KB"} are supported${s?"":" during this preview period"}`;if(e.size>CopilotImageAttacher.getAttachmentSizeLimit()){this.manager.addAmbientError(o),(0,i.d)("size_limit_exceeded",{size:e.size});return}if(null==n)throw this.manager.addAmbientError("Please manually create a thread before uploading an image"),Error("ThreadID resolution for image attachment is not functioning properly");let l=CopilotImageAttacher.makeImageReference(e,n);await this.autocomplete.addToReferences(l,this.state);try{await l.attachment.prefetch()}catch(e){if("string"==typeof e)this.manager.addAmbientError("An error occurred uploading the attachment"),(0,i.d)("ErrorString",{message:e});else if(e instanceof Error){if((0,i.d)(e.name,{message:e.message}),"FileSizeError"===e.name)this.manager.addAmbientError(o);else throw this.manager.addAmbientError("An unexpected error occurred while reading the file"),this.manager.removeReference(l),e}this.manager.removeReference(l);return}this.manager.setImageAttachmentUploaded(l.id,l.attachment),(0,r.BI)("dotcom_chat.vision.image_added",{uploadType:t})}constructor(e,t,n){o(this,"state",void 0),o(this,"manager",void 0),o(this,"autocomplete",void 0),this.state=e,this.manager=t,this.autocomplete=n}}},68956:(e,t,n)=>{n.d(t,{Cb:()=>m,VR:()=>p,YO:()=>u,hH:()=>f,iI:()=>x,k1:()=>h,rj:()=>d});var r=n(97286),a=n(47584),i=n(96540),s=n(82610),o=n(2622),l=n(65615),c=n(7426);function d(e=!0){let{model:t,messages:n}=(0,l.Pk)(),a=(0,c.b)(),u=o.W.customCopilots,m=t?.hasLimitedCapabilities,p=(0,i.useCallback)(e=>{if(!u||m)return{copilots:[],showLimit:!1};let t=(0,s.Q7)(n)[0];return t?{copilots:e.filter(e=>e.slugWithOwner===t.name),showLimit:!0}:{copilots:e,showLimit:!1}},[u,n,m]),{isLoading:h,data:f,refetch:g,isStale:x,isFetched:y}=(0,r.I)({queryKey:["copilot-chat","custom-copilots"],queryFn:()=>a.fetchCustomCopilots(),select:p,enabled:e}),v=(0,i.useCallback)(async()=>!y||x?(await g()).data:f,[f,y,x,g]);return{loading:h,disabled:m,availableCopilots:f?.copilots,showLimit:f?.showLimit,imperativelyFetch:v}}function u(e){return!!o.W.customCopilots&&"slugWithOwner"in e}function m(e){return`${s.VR}/${e}`}function p(){let e=a.fV?.pathname;return e===s.VR||e===`${s.VR}/`}function h(){let e=RegExp(`^${s.VR}/[a-zA-Z0-9]+$`);return!!a.fV?.pathname?.match(e)}function f(){return p()||h()}let g=/\/copilot\/spaces\/([^/]+)/;function x(){let e=a.fV.pathname;return(0,i.useMemo)(()=>{let t=e.match(g);if(!t)return null;let[,n]=t;return parseInt(n??"",10)??null},[e])}},62562:(e,t,n)=>{n.d(t,{J:()=>r});function r(e){let t=e.indexOf("/");if(-1===t||0===t)return`${e} in:name archived:false`;let n=e.slice(0,t),r=e.slice(t+1);return 0===r.length?`org:${n} in:name archived:false`:`org:${n} ${r} in:name archived:false`}},41720:(e,t,n)=>{n.d(t,{X:()=>a});var r=n(94232);function a(e){let t=e.join(","),[n]=(0,r.I)(()=>{let e=/Windows/.test(navigator.userAgent)?"windows":/Macintosh/.test(navigator.userAgent)?"mac":null;return!!e&&t.includes(e)},!1,[t]);return n}},68963:(e,t,n)=>{n.d(t,{V:()=>ez});var r,a=n(74848),i=n(46988),s=n(40458),o=n(53949),l=n(11499),c=n(57572),d=n(38621),u=n(20053),m=n(96540),p=n(96558),h=n(2622),f=n(39046),g=n(5271),x=n(33492),y=n(65615),v=n(7426),b=n(41720),j=n(38568),w=n(47767),I=n(82610),R=n(37937);let C=({manager:e})=>[{label:"Delete conversation",command:"delete",icon:d.TrashIcon,requiresParams:!1,action:async(t,n)=>{e.dispatch({type:"SLASH_COMMANDS_LOADING"});try{let t=e.getSelectedThread(n);if(!t)throw Error("Thread not found");await e.deleteThread(t),(0,i.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_DELETE_THREAD",mode:n.mode}),e.dispatch({type:"SLASH_COMMANDS_LOADED"})}catch{e.dispatch({type:"SLASH_COMMANDS_ERROR"})}}},{label:"Rename conversation",command:"rename",icon:d.PencilIcon,requiresParams:!0,action:async(t,n)=>{e.dispatch({type:"SLASH_COMMANDS_LOADING"});try{let r=e.getSelectedThread(n);if(!r)throw Error("Thread not found");await e.renameThread(r,t),(0,i.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_RENAME",mode:n.mode}),e.dispatch({type:"SLASH_COMMANDS_LOADED"})}catch{e.dispatch({type:"SLASH_COMMANDS_ERROR"})}}},{label:"Start a new conversation",command:"new",icon:d.PlusIcon,requiresParams:!1,action:async(t,n)=>{e.dispatch({type:"SLASH_COMMANDS_LOADING"});try{await e.selectThread(null),(0,i.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_NEW_THREAD",mode:n.mode}),e.dispatch({type:"SLASH_COMMANDS_LOADED"})}catch{e.dispatch({type:"SLASH_COMMANDS_ERROR"})}}}],S=async(e,t,n)=>{if((e[0]??"")!=="/")return!1;e=e.substring(1);let r=C({manager:n}).filter(t=>{let n=(e.split(" ",1)[0]??"").toLowerCase().trim();return t.command.toLowerCase().includes(n)});if(1!==r.length)return!1;let a=r[0],i=e.substring(a.command.length).trim();return await a.action(i,t),!0};var N=n(68956);function A(e){return(0,N.YO)(e)?e.slugWithOwner:e.slug}var _=n(89323),k=n(8338),E=n(21057),T=n(62456);function L({onSelectPanel:e,onSelectAgent:t}){let{availableAgents:n,showLimit:r,disabled:s,loading:o}=(0,E.JE)(),l=n&&n.length>0;return o?(0,a.jsxs)(k.l.Item,{disabled:!0,children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.MentionIcon,{})}),"Extension"]}):s?(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_NOT_SUPPORTED",mode:"immersive"}),e("agents-not-supported")},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.MentionIcon,{})}),"Extension\u2026"]}):l?(0,a.jsxs)(_.W,{children:[(0,a.jsx)(_.W.Anchor,{children:(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION",mode:"immersive"})},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.MentionIcon,{})}),"Extension"]})}),(0,a.jsx)(_.W.Overlay,{width:"small",children:(0,a.jsxs)(k.l,{children:[n.map(e=>(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_SELECTED",mode:"immersive"}),t(e)},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(T.r,{src:e.avatarUrl})}),e.name,(0,a.jsxs)(k.l.Description,{variant:"inline",truncate:!0,children:[E.Z3,e.slug]}),r&&(0,a.jsx)(k.l.Description,{variant:"block",children:"You're limited to one agent per thread."})]},e.slug)),(0,a.jsx)(k.l.Divider,{}),(0,a.jsxs)(k.l.LinkItem,{href:E.bn,onClick:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_MARKETPLACE",mode:"immersive"})},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.TelescopeIcon,{})}),"Marketplace",(0,a.jsx)(k.l.TrailingVisual,{children:(0,a.jsx)(d.LinkExternalIcon,{})})]})]})})]}):(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_EXTENSION_NOT_AVAILABLE",mode:"immersive"}),e("no-agents-available")},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.MentionIcon,{})}),"Extension\u2026"]})}try{L.displayName||(L.displayName="AgentMenu")}catch{}var M=n(75177),D=n(55847),P=n(34614),O=n(74144),B=n(27297);function F({onClose:e}){let t=h.W.customCopilots;return(0,a.jsx)(O.l,{width:"large",title:t?"Copilots and extensions":"Extensions",position:{narrow:"fullscreen",regular:"center"},onClose:e,renderBody:()=>(0,a.jsx)(M.A,{sx:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center",justifyContent:"center",px:4,py:8,flex:1,height:"100%"},children:(0,a.jsxs)(M.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,color:"fg.muted"},children:[(0,a.jsx)(d.TelescopeIcon,{size:24}),(0,a.jsx)(M.A,{as:"h3",sx:{fontSize:2,fontWeight:"bold",mt:2,color:"fg.default"},children:"Chat with your favorite tools and services"}),(0,a.jsx)(M.A,{as:"p",sx:{fontSize:1,fontWeight:"normal"},children:"Browse the marketplace to find extensions for the tools and services you rely on"}),(0,a.jsx)(D.Q,{as:"a",href:E.bn,children:"Browse marketplace"}),(0,a.jsx)(M.A,{sx:{mt:2},children:(0,a.jsx)(P.A,{href:"https://gh.io/copilot-extensions-docs",children:"Documentation"})})]})})})}function U({onClose:e}){let t=(0,v.b)(),n=h.W.customCopilots;return(0,a.jsx)(O.l,{width:"large",title:n?"Copilots and Extensions":"Extensions",position:{narrow:"fullscreen",regular:"center"},onClose:e,renderBody:()=>(0,a.jsx)(M.A,{sx:{display:"flex",flexDirection:"column",textAlign:"center",px:4,py:10,height:"100%",alignItems:"center",justifyContent:"center"},children:(0,a.jsxs)(M.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,color:"fg.muted"},children:[(0,a.jsx)(M.A,{sx:{display:"flex",color:"attention.fg"},children:(0,a.jsx)(d.AlertIcon,{size:24})}),(0,a.jsxs)(M.A,{as:"h3",sx:{fontSize:2,fontWeight:"bold",mt:2,color:"fg.default"},children:[n?"Copilots and extensions":"Extensions"," aren't supported by this model"]}),(0,a.jsxs)(M.A,{as:"p",sx:{fontSize:1,fontWeight:"normal"},children:["Switch back to the ",B.UB.displayName," model or start a new conversation"]}),(0,a.jsx)(D.Q,{onClick:()=>{t.selectThread(null),t.selectModel(B.UB)},children:"New conversation"})]})})})}try{F.displayName||(F.displayName="NoAgentsAvailableDialog")}catch{}try{U.displayName||(U.displayName="AgentsNotSupportedDialog")}catch{}var W=n(80688),z=n(87330),q=n(85349),H=n(84217),$=n(52464),K=n(30631),V=n(30729),G=n(61597),X=n(40961),J=n(10967);let Z={disabledForPreviewModelsPanel:"KnowledgeSelectPanel-module__disabledForPreviewModelsPanel--NqDvF",ActionList_Description:"KnowledgeSelectPanel-module__ActionList_Description--CM7xN"},Q=(0,m.forwardRef)(function({open:e,setOpen:t,...n},r){return(0,a.jsx)(z.K,{ref:r,"aria-expanded":!!e||void 0,"aria-haspopup":!0,"aria-label":"Attach knowledge base","aria-labelledby":void 0,icon:d.BookIcon,onClick:()=>t(!e),sx:{color:"fg.muted"},variant:"invisible",...n})});function Y({disabledForPreviewModelsProps:e,emptyKnowledgeBaseProps:t,open:n,onOpenChange:r,submitReturnFocusRef:i,cancelReturnFocusRef:s}){let l=(0,y.Pk)(),c=(0,v.b)(),d=(0,x.c)(),u=(0,W.A)("localStorage"),{knowledgeBases:p}=l,[f,g]=(0,m.useState)([]),[b,j]=(0,m.useState)(!0),[w,C]=(0,m.useState)(""),S=(0,m.useRef)(null),N=u.getItem("lastUsedKnowledgeBaseId")||"",A=u.getItem("lastUsedKnowledgeBaseOrg")||"";(0,m.useEffect)(()=>{n||C("")},[n]);let _=(0,m.useMemo)(()=>""===w?p:p.filter(e=>e.name.toLowerCase().includes(w.toLowerCase())),[w,p]),E=(0,m.useMemo)(()=>_.reduce((e,t)=>{let n=e.find(e=>e.org===t.ownerLogin);return n?n.docsets.push(t):e.push({org:t.ownerLogin,docsets:[t]}),e},[]),[_]),[T,L]=(0,m.useState)(!1),M=b||"pending"===l.knowledgeBasesLoading.state,D=T||"error"===l.knowledgeBasesLoading.state;(0,m.useEffect)(()=>{let e=async()=>{j(!0),await c.fetchKnowledgeBases();let e=await c.service.listAdministratedCopilotEnterpriseOrganizations();e.ok?g(e.payload||[]):L(!0),j(!1)};n&&e()},[n]);let P=(0,m.useCallback)(e=>{"DIALOG"===e.target.tagName&&r(!1)},[r]);(0,m.useEffect)(()=>(document.addEventListener("click",P),()=>{document.removeEventListener("click",P)}),[P]),(0,m.useEffect)(()=>{if(n&&S.current){let e=S.current.querySelector("input[type=text]");e?.focus()}},[n]);let{currentReferences:O}=l,B=ei(),F=e=>{c.dismissAttachKnowledgeBaseHerePopover(),c.clearCurrentReferences(["image","issue"]),c.clearCurrentTopic(),l.selectedThreadID&&R.J.setSelectedTopic(l.selectedThreadID,null);let t=(0,I.UU)(e);d.addToReferences(t,l),u.setItem("lastUsedKnowledgeBaseId",e.id),u.setItem("lastUsedKnowledgeBaseOrg",e.ownerLogin)},U=(e,t)=>e.id===N?-1:t.id===N?1:0,z=e=>{let t=l.currentReferences.find(t=>(0,I.P)(t)&&t.id===e.id);if(t){c.removeReference(t);return}c.addReference((0,I.UU)(e),"docsetMenu")};return l.model?.hasLimitedCapabilities?(0,a.jsx)(eo,{open:n,setOpen:r,...e}):M||0!==p.length?(0,a.jsx)("div",{ref:S,...(0,o.G)("knowledge-select-panel"),children:(0,a.jsxs)(G.X,{description:"Knowledge bases consolidate content from multiple repositories for an improved chat experience.",onCancel:()=>{(0,X.flushSync)(()=>r(!1)),s.current?.focus()},onSubmit:()=>{(0,X.flushSync)(()=>r(!1)),i.current?.focus()},open:n,selectionVariant:h.W.topicsAsReferences?"multiple":"instant",title:h.W.topicsAsReferences?"Select knowledge bases":"Select a knowledge base",variant:"modal",width:"large",maxHeight:"xlarge",children:[(0,a.jsx)(G.X.Header,{children:(0,a.jsx)(G.X.SearchInput,{onChange:e=>{C(e.currentTarget.value)},placeholder:"Search knowledge bases","aria-label":"Search knowledge bases"})}),(0,a.jsx)(k.l,{sx:{minHeight:340},children:M?(0,a.jsx)(G.X.Loading,{children:"Fetching knowledge bases\u2026"}):D?(0,a.jsx)(G.X.Message,{variant:"error",children:"Failed to load knowledge bases"}):0===E.length?(0,a.jsx)(G.X.Message,{variant:"empty",title:"No knowledge bases found",children:"Try a different search term"}):[...E].sort((e,t)=>e.org===A?-1:t.org===A?1:0).map(e=>(0,a.jsxs)(k.l.Group,{children:[(0,a.jsx)(k.l.GroupHeading,{children:e.org}),[...e.docsets].sort(U).map(e=>(0,a.jsx)(er,{docset:e,selected:O.some(t=>(0,I.P)(t)&&t.id===e.id),onSelect:()=>h.W.topicsAsReferences?z(e):F(e)},e.id))]},e.org))}),B&&(0,a.jsx)(G.X.Footer,{children:(0,a.jsx)(ea,{message:B})})]})}):(0,a.jsx)(ee,{administratedCopilotEnterpriseOrganizations:f,persistentPanelStyles:{position:["fixed","fixed","absolute"],bottom:["60px","60px","0 !important"],"@media screen and (max-height: 480px)":{bottom:"0 !important"},top:"initial !important",left:["18px","18px","calc(50% - 360px) !important"],maxHeight:"100%"},open:n,setOpen:r,mode:l.mode,...t})}function ee({administratedCopilotEnterpriseOrganizations:e,anchorRef:t,open:n,setOpen:r}){let i=ei(),s=t?{anchorRef:t,renderAnchor:null}:{anchorRef:void 0,renderAnchor:({...e})=>(0,a.jsx)(Q,{open:n,setOpen:r,...e})},l=e?.length===0;return(0,a.jsx)(q.T,{open:n,onOpen:()=>r(!0),onClose:()=>r(!1),overlayProps:{anchorSide:"outside-bottom",sx:{width:"min(100%, 350px)"}},...s,children:(0,a.jsxs)(M.A,{role:"dialog","aria-labelledby":"knowledge-base-dialog-title",sx:{display:"flex",flexDirection:"column",...l?{height:"100%"}:{}},...(0,o.G)("empty-knowledge-base-picker"),children:[(0,a.jsx)(M.A,{sx:{borderBottom:"1px solid",borderColor:"border.muted"},children:(0,a.jsxs)(M.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:2,px:3},children:[(0,a.jsx)(H.A,{id:"knowledge-base-dialog-title",as:"h4",sx:{fontSize:1},children:"Attach a knowledge base"}),(0,a.jsx)(z.K,{unsafeDisableTooltip:!0,"aria-label":"Close",icon:d.XIcon,variant:"invisible",onClick:()=>r(!1)})]})}),(0,a.jsxs)(M.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:3,pt:3,...l?{flexGrow:1,maxHeight:"100%",overflowY:"auto"}:{}},children:[(0,a.jsx)(V.A,{icon:d.BookIcon,size:"medium",sx:{color:"fg.muted"}}),(0,a.jsxs)(M.A,{sx:{gap:2,display:"flex",alignItems:"center",flexDirection:"column",...l?{maxHeight:"100%"}:{}},children:[(0,a.jsx)($.A,{sx:{fontSize:1,fontWeight:600},children:"You don't have any knowledge bases"}),(0,a.jsxs)(M.A,{sx:{color:"fg.muted",textAlign:"center",fontSize:0,px:3},children:[(0,a.jsx)("p",{children:"Knowledge bases consolidate content from multiple repositories for an improved chat experience."}),l&&(0,a.jsx)($.A,{as:"p",sx:{mt:3,mb:4},...(0,o.G)("ask-admin-for-knowledge-base"),children:"Speak with an organization owner about creating a knowledge base for your organization."})]}),e.length>0&&(0,a.jsx)(et,{administratedCopilotEnterpriseOrganizations:e})]})]}),i&&(0,a.jsx)(M.A,{sx:{borderTop:"1px solid",borderColor:"border.muted",px:2,py:3},children:(0,a.jsx)(ea,{message:i})})]})})}function et({administratedCopilotEnterpriseOrganizations:e}){return 1===e.length?(0,a.jsx)(D.Q,{as:"a",href:es(e[0]),sx:{mb:4},...(0,o.G)("create-knowledge-base-button"),children:"Create a knowledge base"}):(0,a.jsxs)(M.A,{sx:{width:"100%",textAlign:"left",borderTop:"1px solid",borderColor:"border.muted",pt:3},...(0,o.G)("create-knowledge-base-dropdown"),children:[(0,a.jsx)(H.A,{as:"h3",sx:{fontSize:0,color:"fg.muted",pl:3},children:"Create a knowledge base for an organization"}),(0,a.jsx)(k.l,{sx:{maxHeight:"160px",overflow:"scroll"},children:e.map(e=>(0,a.jsx)(en,{org:e},e.id))})]})}function en({org:e}){return(0,a.jsx)(k.l.Item,{children:(0,a.jsxs)(P.A,{sx:{flex:1,color:"fg.default"},href:es(e),children:[(0,a.jsx)(T.r,{square:!0,src:e.avatarUrl,alt:e.login,sx:{mr:2},"aria-hidden":"true"}),(0,a.jsx)(K.A,{inline:!0,title:e.login,sx:{minWidth:"80%"},children:e.login})]})})}function er({docset:e,selected:t,onSelect:n}){let r=e.sourceRepos?.map(e=>e.id)||[],i=(0,J.r_)(r);return(0,a.jsxs)(k.l.Item,{onSelect:()=>n(),selected:t,disabled:!i,children:[e.name,(0,a.jsx)(k.l.Description,{variant:"block",className:Z.ActionList_Description,children:e.description})]},e.id)}function ea({message:e}){return e?(0,a.jsx)(M.A,{"data-testid":"knowledge-select-panel-sso",sx:{color:"fg.muted",fontSize:0,ml:2},children:e}):null}function ei(){let e=(0,y.Pk)(),t=e.ssoOrganizations.map(e=>e.login);for(let n of e.knowledgeBases)for(let e of n.protectedOrganizations)t.includes(e)||t.push(e);if(!t||0===t.length)return null;if(1===t.length)return`Single sign-on to see content from ${t[0]}.`;if(2===t.length)return`Single sign-on to see content from ${t[0]} and ${t[1]}.`;{let e=t.length-2;return`Single sign-on to see content from ${t[0]}, ${t[1]}, and ${e} organization${e>1?"s":""}`}}function es(e){return`/organizations/${e.login}/settings/copilot/chat_settings/new`}function eo({anchorRef:e,open:t,setOpen:n}){let r=e?{anchorRef:e,renderAnchor:null}:{anchorRef:void 0,renderAnchor:({...e})=>(0,a.jsx)(Q,{open:t,setOpen:n,...e})};return(0,a.jsx)(q.T,{open:t,onOpen:()=>n(!0),onClose:()=>n(!1),...r,children:(0,a.jsxs)("div",{className:(0,u.$)("m-3 d-flex flex-column flex-items-center text-center",Z.disabledForPreviewModelsPanel),children:[(0,a.jsx)(d.AlertIcon,{className:"fgColor-attention mb-3"}),(0,a.jsx)("h3",{className:"h5 mb-2",children:"Knowledge bases aren't supported by this model"}),(0,a.jsx)("span",{className:"text-small fgColor-muted",children:"Switch back to the GPT-4o model or start a new conversation"})]})})}try{Q.displayName||(Q.displayName="KBIconButton")}catch{}try{(r=KBIconButtonInner).displayName||(r.displayName="KBIconButtonInner")}catch{}try{Y.displayName||(Y.displayName="KnowledgeSelectPanel")}catch{}try{ee.displayName||(ee.displayName="EmptyKnowledgeBase")}catch{}try{et.displayName||(et.displayName="CreateKnowledgeBaseButton")}catch{}try{en.displayName||(en.displayName="CreateKnowledgeBaseActionRow")}catch{}try{er.displayName||(er.displayName="KnowledgeBaseSelectRow")}catch{}try{ea.displayName||(ea.displayName="SSOFooter")}catch{}try{eo.displayName||(eo.displayName="DisabledForPreviewModels")}catch{}var el=n(89401),ec=n(70170),ed=n(97286);function eu(e,t){let n={};for(let r of e){let e=t(r);n[e]??(n[e]=[]),n[e].push(r)}return n}let em={chooseRepoInstructionPanel:"ReferencesSelectPanel-module__chooseRepoInstructionPanel--ZB4TR",chooseRepoTitle:"ReferencesSelectPanel-module__chooseRepoTitle--WR2cM",chooseRepoSubtitle:"ReferencesSelectPanel-module__chooseRepoSubtitle--D5U0G"};var ep=n(70642),eh=n(91189),ef=n(59010);function eg(e){let{selectedThreadID:t,currentTopic:n}=(0,y.Pk)(),r=(0,v.b)(),i=(0,m.useCallback)(async e=>{R.J.setSelectedTopic(t??"",e.toString()),r.clearCurrentReferences(["image","issue"]),await r.fetchCurrentRepo(e)},[r,t]);return(0,a.jsx)(ey,{...e,selectionVariant:"instant",selectedRepoIds:new Set(n?[n.id]:[]),onSelectRepo:i,description:"Choose a repository to chat about."})}function ex(e){let{currentReferences:t}=(0,y.Pk)(),n=(0,v.b)(),r=t.filter(e=>"repository"===e.type),i=new Set(r.map(e=>e.id)),[s,o]=(0,m.useState)(),l=async t=>{o(void 0);let a=r.find(e=>e.id===t);if(a){n.removeReference(a);return}let i=await n.service.fetchRepo(t);if(!i.ok){o("Error: failed to attach repository. Please try again."),e.onOpenChange(!0);return}let s=(0,I.qS)(i.payload);n.addReference(s,"repoMenu")};return(0,a.jsx)(ey,{...e,selectionVariant:"multiple",selectedRepoIds:i,onSelectRepo:l,description:"Choose repositories to chat about.",error:s})}function ey({open:e,onOpenChange:t,submitReturnFocusRef:n,cancelReturnFocusRef:r,selectedRepoIds:s,featuredRepoIds:l=s,onSelectRepo:c,selectionVariant:d,description:p,error:h}){let{currentRepository:f,ssoOrganizations:g}=(0,y.Pk)(),[x,v]=(0,m.useState)(!0),[b,j]=(0,m.useState)("");(0,m.useEffect)(()=>{e||j("")},[e]);let[w,I]=(0,m.useState)(void 0),{repositories:R,loading:C}=(0,eh.U)(b,w,I,e,f),S=(0,m.useMemo)(()=>C?"Loading repositories":0===R.length?"No repositories found":1===R.length?"1 repository found":`${R.length} repositories found`,[C,R.length]);(0,m.useEffect)(()=>{R.length>0&&x&&v(!1)},[R.length,x]);let N=(0,m.useMemo)(()=>g?g.map(e=>e.login):[],[g]),{featuredRepos:A,nonFeaturedRepos:_}=eu(R,e=>l.has(e.databaseId)?"featuredRepos":"nonFeaturedRepos"),[E,T]=(0,m.useState)(!1),L=async e=>{T(!0),await c(e),T(!1)};return(0,a.jsx)("div",{...(0,o.G)("repo-select-panel"),children:(0,a.jsxs)(G.X,{width:"large",maxHeight:"xlarge",onCancel:()=>{(0,X.flushSync)(()=>t(!1)),r.current?.focus(),(0,i.BI)("dotcom_chat.activate",{target:"REPOSITORY_DIALOG_CLOSE",mode:"immersive"})},onSubmit:()=>{(0,X.flushSync)(()=>t(!1)),n.current?.focus()},open:e,variant:"modal",selectionVariant:d,title:"multiple"===d?"Select repositories":"Select a repository",description:p,children:[(0,a.jsx)(G.X.Header,{className:(0,u.$)(N.length>0&&"border-bottom-0"),children:(0,a.jsx)(G.X.SearchInput,{loading:C&&!x||E,onChange:e=>{j(e.currentTarget.value)},placeholder:"Search repositories","aria-label":"Search repositories"})}),(0,a.jsx)(ep.x,{portalContainerName:el.f1,protectedOrgs:N,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${location.href}`,isDisplayedInSelectPanel:!0}),(0,a.jsx)(el.hl,{}),h&&(0,a.jsx)(G.X.Message,{variant:"error",size:"inline",children:h}),(0,a.jsxs)(k.l,{sx:{minHeight:340},children:[(0,a.jsx)("div",{role:"status",className:"sr-only",children:S}),C&&x?(0,a.jsx)(G.X.Loading,{children:"Fetching repositories\u2026"}):0!==R.length||C?(0,a.jsxs)(a.Fragment,{children:[A?.map(e=>a.jsx(ef.W,{repo:e,onSelect:L,selected:s.has(e.databaseId)},e.databaseId)),A&&_&&(0,a.jsx)(k.l.Divider,{}),_?.map(e=>a.jsx(ef.W,{repo:e,onSelect:L,selected:s.has(e.databaseId)},e.databaseId))]}):(0,a.jsx)(G.X.Message,{variant:"empty",title:"No repositories found",children:"Try a different search term"})]})]})})}try{eg.displayName||(eg.displayName="RepoTopicSelectPanel")}catch{}try{ex.displayName||(ex.displayName="RepoReferencesSelectPanel")}catch{}try{ey.displayName||(ey.displayName="RepoSelectPanel")}catch{}let ev=e=>`Choose items from ${e} to chat about. Use fewer references for more accurate responses.`,eb="Search",ej=({open:e,onOpenChange:t,...n})=>{let{currentTopic:r}=(0,y.Pk)();return(0,I.Z6)(r)?(0,a.jsx)(eI,{...n,open:e,onOpenChange:t,sourceRepository:r}):(0,a.jsx)(eR,{open:e,setOpen:t})},ew=({open:e,onOpenChange:t,cancelReturnFocusRef:n,submitReturnFocusRef:r,...i})=>{let s=(0,v.b)(),[o,l]=(0,m.useState)();(0,m.useEffect)(()=>l(void 0),[e]);let c=new Set((0,y.pn)(e=>e.currentReferences).filter(e=>"repository"===e.type).map(e=>e.id)),[d,u]=(0,m.useState)(),p=(0,m.useRef)(!1),h=async e=>{u(void 0),p.current=!0;let t=await s.service.fetchRepo(e);t.ok?l(t.payload):u("Error: failed to load repository details. Please try again."),p.current=!1};return o?(0,a.jsx)(eI,{...i,open:e,onOpenChange:t,sourceRepository:o,cancelReturnFocusRef:n,submitReturnFocusRef:r}):(0,a.jsx)(ey,{selectionVariant:"instant",open:e,onOpenChange:e=>{p.current||t(e)},selectedRepoIds:new Set,onSelectRepo:h,cancelReturnFocusRef:n,submitReturnFocusRef:r,description:"Choose a repository to browse for files and symbols.",featuredRepoIds:c,error:d})},eI=({renderAnchor:e,anchorRef:t,open:n,onOpenChange:r,submitReturnFocusRef:i,cancelReturnFocusRef:s,sourceRepository:o})=>{let{findFileWorkerPath:l}=(0,y.Pk)(),[c,d]=(0,m.useState)(""),u=(0,m.useRef)((0,ec.s)(d,250));(0,m.useEffect)(()=>{n||d("")},[n]);let{initialLoading:p,filterLoading:h,selected:f,unselected:g,toggleSelection:b}=function(e,t,n,r){let a=(0,y.Pk)(),i=(0,v.b)(),s=(0,x.c)(),o=function(e,t,n,r,a){let i=(0,x.c)(),s=new Map(a.filter(e=>"file"===e.type&&e.repoID===t?.id).map(e=>[e.path,e])),o=new Map(a.filter(e=>"folder"===e.type&&e.repoID===t?.id).map(e=>[e.path,e])),l=new Map(a.filter(e=>"symbol"===e.type&&"suggestionSymbol"===e.kind&&(e.suggestionDefinitions?.some(e=>e.repoID===t?.id)??!1)).map(e=>[e.name,e])),{isLoading:c,data:d}=(0,ed.I)({queryKey:["copilot-chat","files-autocomplete",t?.ownerLogin,t?.name,e],queryFn:async()=>t?(await i.fetchAutocompleteSuggestions(t,e),{filePaths:eN(Array.from(i.fileSuggestions.values()).map(e=>e.path),s.keys()),folderPaths:eN(Array.from(i.folderSuggestions.values()).map(e=>e.path),o.keys()),symbolNames:eN(Array.from(i.symbolSuggestions.values()).map(e=>e.name),l.keys())}):null,enabled:r}),[u,m]=(0,J.U2)(d?.filePaths??null,e,n),[p,h]=(0,J.U2)(d?.folderPaths??null,e,n),[f,g]=(0,J.U2)(d?.symbolNames??null,e,n),y=[...u.slice(0,7).map(e=>i.fileSuggestions.get(e)??s.get(e)).filter(e=>!!e).map(e=>eA(e)).filter(e=>!!e),...p.slice(0,7).map(e=>i.folderSuggestions.get(e)??o.get(e)).filter(e=>!!e).map(e=>eA(e)).filter(e=>!!e),...f.slice(0,7).map(e=>i.symbolSuggestions.get(e)??l.get(e)).filter(e=>!!e).map(e=>eA(e)).filter(e=>!!e)],v=c&&!e;return{items:y,filterLoading:!v&&(c||m||h||g),initialLoading:v}}(t,n,r,e,a.currentReferences),l=a.currentReferences.map(e=>(0,I.Vb)(e)).filter(e=>void 0!==e),{selected:c=[],unselected:d=[]}=eu(o.items,e=>l.includes(e.id)?"selected":"unselected"),u=(0,m.useCallback)(async e=>{let t=a.currentReferences.find(t=>e.id===(0,I.Vb)(t));t?i.removeReference(t):await e_(e,a,s)},[s,i,a]);return{...o,selected:c,unselected:d,toggleSelection:u}}(n,c,o,l),j=f.length+g.length,w=`${o.ownerLogin}/${o.name}`;return(0,a.jsxs)(M.A,{sx:{flexGrow:"0 !important"},children:[e?.({}),(0,a.jsxs)(G.X,{anchorRef:t,title:"Select files, folders, and symbols",description:ev(w),onCancel:()=>{(0,X.flushSync)(()=>r(!1)),i.current?.focus()},onSubmit:()=>{(0,X.flushSync)(()=>r(!1)),s.current?.focus()},open:n,selectionVariant:"multiple",variant:"modal",width:"large",maxHeight:"xlarge",children:[(0,a.jsx)(G.X.Header,{children:(0,a.jsx)(G.X.SearchInput,{loading:h,onChange:e=>u.current(e.target.value),placeholder:eb,"aria-label":eb})}),(0,a.jsx)(k.l,{sx:{minHeight:340},children:p?(0,a.jsx)(G.X.Loading,{children:"Fetching files, folders, and symbols\u2026"}):0!==j||h?(0,a.jsxs)(a.Fragment,{children:[f.map(e=>(0,a.jsx)(eS,{item:e,selected:!0,toggleSelection:b},e.id)),f.length>0&&g.length>0&&(0,a.jsx)(k.l.Divider,{}),g.map(e=>(0,a.jsx)(eS,{item:e,selected:!1,toggleSelection:b},e.id))]}):(0,a.jsx)(G.X.Message,{variant:"empty",title:"No files or symbols found",children:"Try a different search term"})})]})]})};function eR({open:e,setOpen:t,renderAnchor:n}){return(0,a.jsx)(q.T,{open:e,onOpen:()=>t(!0),onClose:()=>t(!1),renderAnchor:e=>n?.(e)??(0,a.jsx)(a.Fragment,{}),children:(0,a.jsxs)("div",{className:em.chooseRepoInstructionPanel,children:[(0,a.jsx)(d.PaperclipIcon,{}),(0,a.jsx)("h3",{className:em.chooseRepoTitle,children:"Attach a repository first"}),(0,a.jsx)("p",{className:em.chooseRepoSubtitle,children:"To pick attachments, attach a repository where the files are stored."})]})})}let eC=e=>`reference-list-item-${e.id}`;function eS({toggleSelection:e,selected:t,item:n}){return(0,a.jsxs)(k.l.Item,{onSelect:()=>{e(n),setTimeout(()=>{document.getElementById(eC(n))?.focus()})},selected:t,"aria-checked":t,id:eC(n),sx:{mx:2,'&[data-is-active-descendant="activated-directly"]':{backgroundColor:"transparent",outline:"2px solid var(--focus-outlineColor, var(--color-accent-emphasis))",outlineOffset:"-2px"}},children:[(0,a.jsx)(k.l.LeadingVisual,{children:n.renderLeadingVisual()}),(0,a.jsx)(M.A,{sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:n.text})]})}function eN(e,t){return Array.from(new Set([...e,...t]))}function eA(e){let t=(0,I.Vb)(e);switch(e.type){case"symbol":return{id:t,key:t,renderLeadingVisual:()=>(0,a.jsx)(d.CodeSquareIcon,{}),text:e.name};case"file":return{id:t,key:t,renderLeadingVisual:()=>(0,a.jsx)(d.FileIcon,{}),text:e.path};case"folder":return{id:t,key:t,renderLeadingVisual:()=>(0,a.jsx)(d.FileDirectoryFillIcon,{}),text:e.path};case"file-diff":return{id:t,key:t,renderLeadingVisual:()=>(0,a.jsx)(d.FileDiffIcon,{}),text:(0,I.Mw)(e)}}}async function e_(e,t,n){if(e.id&&"string"==typeof e.id&&e.text){let r=n.symbolSuggestions.get(e.text),a=n.fileSuggestions.get(e.text),i=n.folderSuggestions.get(e.text);r&&await n.addToReferences(r,t),a&&await n.addToReferences(a,t),i&&await n.addToReferences(i,t)}}try{ej.displayName||(ej.displayName="TopicReferencesSelectPanel")}catch{}try{ew.displayName||(ew.displayName="MultistepReferencesSelectPanel")}catch{}try{eI.displayName||(eI.displayName="ReferencesSelectPanel")}catch{}try{eR.displayName||(eR.displayName="ChooseRepositoryInstruction")}catch{}try{eS.displayName||(eS.displayName="ReferenceListItem")}catch{}function ek({panel:e,onPanelChange:t,anchorRef:n,...r}){let{inputRef:s}=r,o=(0,v.b)(),l=(0,y.Pk)(),c=(0,x.c)(),u=!!h.W.topicsAsReferences||(0,I.Z6)(l.currentTopic),p=l.renderKnowledgeBases&&(l.currentTopic&&(0,I.Z6)(l.currentTopic)||!l.currentTopic),{model:g}=(0,y.bP)("model"),b=h.W.attachImagesImmersive&&"immersive"===l.mode&&!!g.capabilities.supports.vision||!1,j=(0,E.kw)(r),w=(0,m.useRef)(null);return(0,a.jsxs)("div",{children:[b&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("input",{id:"image-uploader",hidden:!0,ref:w,type:"file",accept:f.s.getAllowedImageFileExtensions(g),onChange:e=>{if(!e.target.files)return;let t=e.target.files[0];e.currentTarget.value="",t&&new f.s(l,o,c).addImageAttachment(t,"menu")}})}),(0,a.jsx)(_.W,{anchorRef:n,open:"attachment-types"===e,onOpenChange:e=>t(t=>e&&null===t?"attachment-types":e||"attachment-types"!==t?t:null),children:(0,a.jsx)(_.W.Overlay,{width:"small",side:"outside-top",align:"end",portalContainerName:"assistive"===l.mode?el.E5:void 0,children:(0,a.jsxs)(k.l,{children:[(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_REFERENCES",mode:l.mode}),t("references")},inactiveText:u?void 0:"First attach a repository",children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.FileCodeIcon,{})}),"Files, folders, and symbols\u2026"]}),(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_REPOSITORIES",mode:l.mode}),t("repositories")},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.RepoIcon,{})}),h.W.topicsAsReferences?"Repositories":"Repository","\u2026"]}),p&&(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_KNOWLEDGE_BASES",mode:l.mode}),t("knowledge-bases")},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.BookIcon,{})}),h.W.topicsAsReferences?"Knowledge bases":"Knowledge base","\u2026"]}),b&&(0,a.jsxs)(k.l.Item,{onSelect:()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU_IMAGES",mode:l.mode}),t(null),w.current?.click()},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.ImageIcon,{})}),"Image\u2026"]}),(0,a.jsx)(L,{onSelectPanel:e=>t(e),onSelectAgent:e=>setTimeout(()=>j(e.slug))})]})})}),h.W.topicsAsReferences?(0,a.jsx)(ew,{open:"references"===e,onOpenChange:e=>t(e?"references":null),submitReturnFocusRef:s,cancelReturnFocusRef:n}):(0,a.jsx)(ej,{open:"references"===e,onOpenChange:e=>t(e?"references":null),submitReturnFocusRef:s,cancelReturnFocusRef:n}),h.W.topicsAsReferences?(0,a.jsx)(ex,{open:"repositories"===e,onOpenChange:e=>t(e?"repositories":null),submitReturnFocusRef:s,cancelReturnFocusRef:n}):(0,a.jsx)(eg,{open:"repositories"===e,onOpenChange:e=>t(e?"repositories":null),submitReturnFocusRef:s,cancelReturnFocusRef:n}),(0,a.jsx)(Y,{disabledForPreviewModelsProps:{anchorRef:n},emptyKnowledgeBaseProps:{anchorRef:n},open:"knowledge-bases"===e,onOpenChange:e=>t(e?"knowledge-bases":null),submitReturnFocusRef:s,cancelReturnFocusRef:n}),"no-agents-available"===e&&(0,a.jsx)(F,{onClose:()=>t(null)}),"agents-not-supported"===e&&(0,a.jsx)(U,{onClose:()=>t(null)})]})}try{ek.displayName||(ek.displayName="AttachmentMenu")}catch{}var eE=n(70255);function eT({children:e,textAreaRef:t}){let n=(0,v.b)(),{mode:r}=(0,y.Pk)(),[s,o]=(0,m.useState)(()=>"undefined"!=typeof document);(0,m.useEffect)(()=>o(!0),[]);let[l,c]=(0,m.useState)(null),d=(0,E.JE)(l?.trigger.triggerChar===E.Z3),u=(0,m.useMemo)(()=>{if(!l)return null;let e=t.current?.value??"",s=t.current?.selectionStart??0;if((e[0]??"")!==l?.trigger.triggerChar||s>1&&e[s-2]?.match(/\s/))return null;let o=l.query.toLowerCase(),c=e=>{let t=e.toLowerCase();return t.startsWith(o)&&t!==o};switch(l.trigger.triggerChar){case"/":if("immersive"===r)break;return""===o&&(0,i.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_MENU_TRIGGERED",mode:r}),C({manager:n}).filter(e=>c(e.command)).map(e=>({value:e.command,key:e.command,render:t=>(0,a.jsxs)(k.l.Item,{...t,onSelect:()=>(0,i.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_MENU_ITEM_SELECTED",mode:r,command:e.command}),children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(V.A,{icon:e.icon})}),(0,a.jsx)("span",{className:"text-normal",children:e.label}),(0,a.jsxs)(k.l.Description,{variant:"inline",truncate:!0,children:["/",e.command]})]},e.label)}));case E.Z3:if(d.disabled)break;if(d.loading)return"loading";return""===o&&(0,i.BI)("dotcom_chat.activate",{target:"AGENT_COMMAND_MENU_TRIGGERED",mode:r}),(d.availableAgents?.filter(e=>c(e.slug)).slice(0,10)??[]).map(e=>({value:e.slug,key:e.slug,render:t=>(0,a.jsxs)(k.l.Item,{...t,onSelect:()=>(0,i.BI)("dotcom_chat.activate",{target:"AGENT_COMMAND_MENU_ITEM_SELECTED",mode:r,command:e.slug}),children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(T.r,{src:e.avatarUrl})}),e.name,(0,a.jsxs)(k.l.Description,{variant:"inline",truncate:!0,children:[E.Z3,e.slug]}),d.showLimit&&(0,a.jsx)(k.l.Description,{variant:"block",children:"You're limited to one agent per thread."})]},e.slug)}))}return null},[l,t,r,n,d.disabled,d.loading,d.availableAgents,d.showLimit]);return s?(0,a.jsx)(eE.a,{fullWidth:!0,suggestions:u,triggers:[{triggerChar:"/"},{triggerChar:E.Z3}],tabInsertsSuggestions:!1,onHideSuggestions:()=>c(null),onShowSuggestions:e=>c(e),children:e}):(0,a.jsx)("div",{children:e})}try{eT.displayName||(eT.displayName="Autocomplete")}catch{}let eL={container:"ChatInput-module__container--NFzCy",input:"ChatInput-module__input--iApWs",clicked:"ChatInput-module__clicked--hHA9l",attachments:"ChatInput-module__attachments--a9G6d",inputContainer:"ChatInput-module__inputContainer--BcExV",inputPreview:"ChatInput-module__inputPreview--f_0H3",token:"ChatInput-module__token--g4p0s",inputPreviewRef:"ChatInput-module__inputPreviewRef--SxNz0",trailingActions:"ChatInput-module__trailingActions--q2BNB",containerSmall:"ChatInput-module__containerSmall--PJkO5"};var eM=n(69676),eD=n(82678),eP=n(63867),eO=n(69425);let eB={container:"ChatInputReferences-module__container--kZx3r",attachmentsList:"ChatInputReferences-module__attachmentsList--c0Z3e",scrolledToEnd:"ChatInputReferences-module__scrolledToEnd--qEVr3",loading:"ChatInputReferences-module__loading--G1S4m",divider:"ChatInputReferences-module__divider--m7eF_",menuButton:"ChatInputReferences-module__menuButton--R82CM",functionLoading:"ChatInputReferences-module__functionLoading--_Tp1T"};var eF=n(60068);let eU=({className:e,isLoading:t,returnFocusRef:n,tokenSize:r="medium",onClickReference:i})=>{let{currentReferences:s}=(0,y.Pk)(),l=(0,v.b)(),c=(0,m.useRef)(null),p=(0,eO.g)(c),h=(0,m.useMemo)(()=>(0,I.rT)(s),[s]),f=(0,m.useRef)(null);(0,eD.G)({containerRef:f,focusableElementFilter:e=>!e.hasAttribute("aria-hidden"),bindKeys:eM.z0.ArrowHorizontal|eM.z0.HomeAndEnd,focusInStrategy:"previous",focusOutBehavior:"stop"},[h]);let g=(0,m.useRef)([]),x=(e,t)=>{let r=g.current[t+1]??g.current[t-1]??n.current;r?.focus(),l.removeReference(e)},b=(0,m.useRef)(h);return((0,j.N)(()=>{if(b.current.length<h.length){let e=h.find(e=>!b.current.find(t=>(0,I.x_)(t,e))),t=e?h.indexOf(e):-1;g?.current?.[t]?.scrollIntoView({behavior:"smooth",inline:"end"})}b.current=h},[h]),0!==h.length||t)?(0,a.jsxs)("div",{role:"toolbar","aria-label":"Attachments",className:(0,u.$)(e,eB.container),ref:f,children:[(0,a.jsxs)("div",{className:(0,u.$)(eB.attachmentsList,p&&eB.scrolledToEnd,t&&eB.loading),ref:c,children:[h.map((e,t)=>"repository"===e.type?(0,a.jsx)(eW,{reference:e,ref:e=>{g.current[t]=e},"data-index":t,size:r,onRemove:()=>x(e,t),onClick:i},(0,I.Vb)(e)):(0,a.jsx)(eF.B,{reference:e,ref:e=>{g.current[t]=e},"data-index":t,size:r,onRemove:()=>x(e,t),onClick:i},(0,I.Vb)(e))),t&&(0,a.jsxs)("div",{className:eB.functionLoading,...(0,o.G)("loading-indicator"),children:[(0,a.jsx)(eP.A,{size:"small"}),"Retrieving\u2026"]})]}),(0,a.jsx)("div",{className:eB.divider}),(0,a.jsxs)(_.W,{children:[(0,a.jsx)(_.W.Anchor,{children:(0,a.jsx)(z.K,{icon:d.KebabHorizontalIcon,"aria-label":"Attachments options",variant:"invisible",tooltipDirection:"n",className:eB.menuButton,size:r})}),(0,a.jsx)(_.W.Overlay,{width:"small",children:(0,a.jsx)(k.l,{children:(0,a.jsxs)(k.l.Item,{onSelect:()=>{setTimeout(()=>n.current?.focus()),l.clearCurrentReferences()},children:[(0,a.jsx)(k.l.LeadingVisual,{children:(0,a.jsx)(d.TrashIcon,{})}),"Remove attachments"]})})})]})]}):null},eW=(0,m.forwardRef)(function(e,t){let n=e.reference,r=(0,y.pn)(e=>e.model&&!e.model.hasLimitedCapabilities),i=`${n.ownerLogin}/${n.name}`,[s,o]=(0,J.vn)(i),l=(0,m.useRef)(!1),c=s.code===J.W5.Unindexed||s.docs===J.W5.Unindexed;return(0,m.useEffect)(function(){!l.current&&c&&r&&(l.current=!0,o())},[r,c,o]),(0,a.jsx)(eF.B,{ref:t,...e})});try{eU.displayName||(eU.displayName="ChatInputReferences")}catch{}try{eW.displayName||(eW.displayName="RepoReferenceToken")}catch{}try{eW.displayName||(eW.displayName="RepoReferenceToken")}catch{}let ez=e=>{let t=(0,y.Pk)(),n=(0,x.c)(),r=(0,v.b)(),C=r.maxMessagesReached(),N="loading"===t.slashCommandLoading.state,A=e.hideAttachmentButton||!1,{typingHasStarted:_,textAreaRef:k,textareaPreviewRef:E,textAreaPreviewContainerRef:T,text:L,setText:M,handleSubmit:D,handleSubmitToNewThread:P,handleScroll:O,handleChange:B,handleStop:F,handleFocus:U}=function(e){let t=(0,y.Pk)(),n=(0,v.b)(),r=(0,x.c)(),{selectedThreadID:a}=t,s=R.J.getSavedMessage(a),o=R.J.getSavedUserMessageOnError(a),[l,c]=(0,m.useState)(o??s??""),[d,u]=(0,m.useState)(!1),p=(0,b.X)(["mac"]),f=(0,m.useRef)(null),g=e.textAreaRef||f,C=(0,m.useRef)(null),N=(0,m.useRef)(null),A=t.messages.filter(e=>"user"===e.role),_=(0,m.useRef)(0),{search:k,pathname:E}=(0,w.zy)(),T=(0,m.useRef)(null),L=(0,m.useRef)(()=>{}),M=(0,m.useCallback)(async()=>{t.renderAttachKnowledgeBaseHerePopover&&await n.fetchKnowledgeBases()},[n,t.renderAttachKnowledgeBaseHerePopover]);(0,m.useEffect)(()=>{if("immersive"!==t.mode)return;let e=new URLSearchParams(k).get("prompt");e&&("/copilot"===E||"/copilot/"===E)?(c(e),(0,i.BI)("dotcom_chat.activate",{target:"COPILOT_PROMPT_LOADED_FROM_URL",mode:"immersive"})):c("")},[k,E,t.mode]),(0,m.useEffect)(()=>{M()},[M]);let D=e=>p?e.metaKey:e.ctrlKey;(0,m.useEffect)(()=>{(async function(){if(h.W.topicsAsReferences)return;let e=t.currentTopic;e&&(0,I.Z6)(e)&&void 0!==t.currentTopic&&await r.fetchAutocompleteSuggestions(e,"")})()},[r,t.currentTopic]),(0,m.useEffect)(()=>{R.J.setSavedMessage(a,l)},[a,l]),(0,j.N)(()=>{let e=0;!function t(){if(!g.current||!N.current||!C.current)return;e++,0===g.current.scrollHeight&&e<10&&setTimeout(t,1),g.current.style.height="0";let n=g.current.scrollHeight,r=Math.min(n,300);C.current.style.height=`${n}px`,g.current.style.height=`${n}px`,N.current.style.height=`${r}px`}()},[l,g,C]);let P=async e=>{u(!0),"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.altKey||e.nativeEvent.isComposing?D(e)&&e.shiftKey&&"s"===e.key?(e.preventDefault(),await F()):"ArrowUp"===e.key&&g.current&&(""===g.current.value||_.current>0)&&0===g.current.selectionStart&&A?.length>_.current&&"assistive"===t.mode?(e.preventDefault(),_.current++,c(A[A.length-_.current].content||"")):"ArrowDown"===e.key&&_.current>0&&g.current&&g.current.selectionStart===g.current.value.length&&"assistive"===t.mode&&(e.preventDefault(),_.current--,0===_.current?c(""):c(A[A.length-_.current].content||"")):(e.preventDefault(),await B()),O()},O=(0,m.useCallback)(()=>{g?.current&&C?.current&&N?.current&&(C.current.scrollTop=g.current.scrollTop,C.current.scrollLeft=g.current.scrollLeft)},[g]),B=async r=>{if(u(!1),R.J.clearSavedUserMessage(a),R.J.clearSavedUserMessageOnError(a),t.defaultRecipient&&!l.includes(`@${t.defaultRecipient}`)&&(t.defaultRecipient=void 0),r?.preventDefault(),"assistive"===t.mode&&await S(l,t,n)){(0,i.BI)("dotcom_chat.activate",{target:"SLASH_COMMAND_EXECUTED",mode:t.mode,command:l}),"/new"===l.trim()&&R.J.setSavedMessageFast(a,null),c("");return}if(e.isLoading)e.onAbort?.();else{let r=l;if(!r){let e=t.currentReferences,[a,i]=n.tryInferMessage(e);if(!a||!i)return;r=i}c(""),await e.onSubmit?.(r)}},F=(0,m.useCallback)(()=>n.sendMessageToNewThread(a,l,t.currentReferences,t.context),[n,a,t.context,t.currentReferences,l]),U=(0,m.useCallback)(e=>{u(!0),g?.current&&(c(e.target.value),_.current=0,O())},[O,g]),W=(0,m.useCallback)(async()=>{await n.stopStreaming(),null!=a&&(n.startThreadReload(),await new Promise(e=>{T.current=setTimeout(()=>e(a),6e3)}),L.current=await n.fetchMessages(a,!0,!0))},[n,a]);return(0,m.useEffect)(()=>{L.current&&(L.current(),L.current=()=>{})},[t.messages]),(0,m.useEffect)(()=>()=>{T.current&&(clearTimeout(T.current),T.current=null),n.cancelThreadReload(),L.current=()=>{}},[n]),{typingHasStarted:d,textAreaRef:g,textareaPreviewRef:C,textAreaPreviewContainerRef:N,text:l,setText:c,handleSubmit:B,handleSubmitToNewThread:F,handleKeyDown:P,handleScroll:O,handleChange:U,handleStop:W,handleFocus:e=>{e.currentTarget.setSelectionRange(e.currentTarget.value.length,e.currentTarget.value.length)},shouldShowKnowledge:t.renderKnowledgeBases&&(t.currentTopic&&(0,I.Z6)(t.currentTopic)||!t.currentTopic)}}({isLoading:t.isWaitingOnCopilot||N||t.currentReferences.some(e=>"image"===e.type&&!e.attachment.isLoaded),onSubmit:e.onSubmit,onAbort:e.onAbort,textAreaRef:e.textAreaRef}),W=t.isWaitingOnCopilot?`Copilot is responding\u{2026}`:t.defaultRecipient?void 0:C?"Message limit reached. To continue chatting with Copilot, start a new conversation.":e.placeholder?e.placeholder:"Ask Copilot";t.defaultRecipient&&""===L&&!_&&M(`@${t.defaultRecipient} `);let[z,q]=(0,m.useState)([]),H=(0,m.useMemo)(()=>z.filter(e=>!e.loadedRefData),[z]),$=(0,s.E)({queries:H.map(e=>({enabled:h.W.copilotUIRefs,queryKey:["copilot","chat-links","item-url",e.originalText],queryFn:async()=>{let t=await (0,c.lS)(`/copilot/chat-links?item_url=${e.originalText}`),n=await t.json();if(eV(n)||eG(n)||eX(n)||eJ(n))return n}})),combine:e=>({data:e.map(e=>e.data).filter(e=>!!e),pending:e.some(e=>e.isPending)})});(0,m.useEffect)(()=>{if(!$.pending&&$.data.length>0){let e=[...z];for(let n of $.data)"issue"!==n.type&&"pull-request"!==n.type&&"discussion"!==n.type||t.currentReferences.find(e=>e.type===n.type&&e.number===n.number)||(e=e.map(e=>e.type===n.type&&e.linkNumber===n.number?{...e,loadedRefData:!0}:e),r.addReference(n,"chatInput")),"immersive"===t.mode&&h.W.immersiveFigmaIntegration&&"figma"===n.type&&!t.currentReferences.find(e=>"figma"===e.type&&e.url===n.url)&&(e=e.map(e=>e.originalText===n.url?{...e,id:n.id,loadedRefData:!0}:e),r.addReference(n,"chatInput"));if(h.W.copilotUIRefs){let{processedText:n,processedRefs:r}=eK(L,e,"immersive"===t.mode,!0);M(n),q(r)}}},[$.data,$.pending,r,M,t.currentReferences,t.mode,L,z]);let K=(0,m.useRef)(t.currentReferences);(0,m.useEffect)(()=>{if(h.W.copilotUIRefs&&t.currentReferences.length<K.current.length){let e=z.map((e,n)=>t.currentReferences.find(t=>"issue"===t.type&&"issue"===e.type&&e.linkNumber===t.number||"discussion"===t.type&&"discussion"===e.type&&e.linkNumber===t.number||"pull-request"===t.type&&"pull-request"===e.type&&e.linkNumber===t.number||"figma"===t.type&&"figma"===e.type&&e.originalText===t.url)?-1:n).filter(e=>-1!==e);q(z.filter((t,n)=>!e.includes(n)))}K.current=t.currentReferences},[t.currentReferences,z]);let V=(0,m.useRef)(null),[G,X]=(0,m.useState)(null),{model:J}=(0,y.bP)("model"),Z=h.W.attachImagesImmersive&&"immersive"===t.mode&&!!J.capabilities.supports.vision||!1,Q=(0,m.useCallback)((e,a)=>{if(!Z||!e)return;let i=Array.from(e),s=i.filter(e=>f.s.isTypeAllowed(e.type,J));if(s.length!==i.length&&(0,g.d)("included_unsupported_file",{fileTypes:i.map(e=>e.type).join(","),uploadType:a}),s.length>0){let e=new f.s(t,r,n);for(let t of s)e.addImageAttachment(t,a)}},[Z,J,t,r,n]),Y=(0,m.useCallback)(e=>{e.preventDefault(),Q(e.dataTransfer?.files||null,"drag")},[Q]),ee=Z&&h.W.wholeAreaDragDrop;return(0,m.useEffect)(()=>{if(ee)return;let e=k?.current;if(!e)return;let t=e=>e.preventDefault();return e.addEventListener("dragover",t),e.addEventListener("drop",Y),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",Y)}},[k,ee,Y]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.tL,{commands:{"github:cancel":()=>{(0,i.BI)("dotcom_chat.activate",{target:"CHAT_MESSAGE_STOP",mode:t.mode}),F()},"copilot-chat:send-message":()=>{q([]),D()},"copilot-chat:send-message-new-conversation":()=>void P(),"copilot-chat:add-attachment":()=>{(0,i.BI)("dotcom_chat.activate",{target:"ATTACHMENT_MENU",mode:t.mode}),X("attachment-types"===G?null:"attachment-types")},"copilot-chat:edit-last-message":0===L.length?()=>{let e=t.messages.findLast(e=>"user"===e.role)?.id;e&&r.startEditingMessage(e)}:void 0,"copilot-chat:deep-codesearch":()=>{(0,i.BI)("dotcom_chat.activate",{target:"DEEP_CODESEARCH",mode:t.mode}),r.dispatch({type:"SET_DEEP_CODESEARCH",deepCodeSearch:!t.skillOptions?.deepCodeSearch})}},children:(0,a.jsxs)("form",{className:(0,u.$)(eL.container,{[eL.containerSmall]:"small"===e.size}),children:[(0,a.jsx)(eU,{className:eL.attachments,returnFocusRef:V,tokenSize:"small"===e.size?"small":"medium",isLoading:$.pending&&z.some(e=>!e.loadedRefData),onClickReference:e.onClickReference}),(0,a.jsxs)(l.tL.LimitKeybindingScope,{commandIds:["github:cancel","copilot-chat:send-message","copilot-chat:edit-last-message"],className:eL.inputContainer,ref:T,children:[(0,a.jsx)(eT,{textAreaRef:k,children:(0,a.jsx)("textarea",{autoFocus:!0,id:p.wg,className:eL.input,autoComplete:"off",autoCorrect:"off",spellCheck:"false","aria-multiline":"true",onPaste:e=>{let n=e.clipboardData;if(n?.items){let r=[];for(let e=0;e<n.items.length;e++){let a=n.items[e];if(a&&"file"===a.kind){let e=a.getAsFile();e&&r.push(e)}if(h.W.copilotUIRefs&&a&&"string"===a.kind&&a.type.match("^text")){let{processedRefs:e}=eK(`${L}${n.getData(a.type)}`,z,"immersive"===t.mode);q(e)}}if(r.length>0){e.preventDefault();let t=new DataTransfer;for(let e of r)t.items.add(e);Q(t.files,"paste")}}},ref:k,onScroll:O,onChange:e=>{if(B(e),h.W.copilotUIRefs){let{processedText:n,processedRefs:r}=eK(e.target.value,z,"immersive"===t.mode,!0);M(n),q(r)}},onFocus:U,placeholder:W,value:L,"data-react-autofocus":!0,disabled:C,...(0,o.G)("copilot-chat-input-textarea")})}),(0,a.jsx)(eq,{text:L,textareaPreviewRef:E,textInputRefs:z,size:e.size})]}),(0,a.jsxs)("div",{className:eL.trailingActions,children:[h.W.showDeepCodeSearchButton&&(0,a.jsx)(l.N5,{commandId:"copilot-chat:deep-codesearch",icon:d.RocketIcon,variant:"invisible",tooltipDirection:"n",className:(0,u.$)({[eL.clicked]:t.skillOptions?.deepCodeSearch})}),!A&&(0,a.jsx)(l.N5,{commandId:"copilot-chat:add-attachment",icon:d.PaperclipIcon,variant:"invisible",ref:V,tooltipDirection:"n"}),e.isStreaming||t.isWaitingOnCopilot?(0,a.jsx)(e$,{}):(0,a.jsx)(eH,{isLoading:N||t.currentReferences.some(e=>"image"===e.type&&!e.attachment.isLoaded)})]})]})}),(0,a.jsx)(ek,{inputRef:k,inputOnChange:B,anchorRef:V,panel:G,onPanelChange:X})]})};function eq(e){let{text:t,textareaPreviewRef:n,textInputRefs:r}=e,{mention:i,textAfterMention:s}=function({text:e,textareaPreviewRef:t}){let n=(0,v.b)(),r=(0,y.Pk)(),[a,i]=(0,m.useState)(""),[s,o]=(0,m.useState)(""),{agents:l,customCopilots:c,agentsPath:d,messages:u}=(0,y.Pk)();return(0,m.useEffect)(()=>{if(!t.current)return;let r=e.match(/^@\S+/g);if(r&&r.length>0){let t;!l&&d&&n.fetchAgents(d),h.W.customCopilots&&!c&&n.fetchCustomCopilots();let a=[];if(l&&a.push(...l),c&&a.push(...c),0===a.length)return;let s=(0,I.Q7)(u);if(s.length>0){let e=s[0];t=a.filter(t=>A(t)===e.name)}else t=a;let m=r[0],p=m.substring(1);if(t.find(e=>A(e)===p)){i(m),o(e.replace(m,""));return}}i(""),o("")},[l,d,c,n,u,r.mode,e,t]),{mention:a,textAfterMention:s}}(e),l=function(e,t){let n=[],r=e.split(" ");for(let e=0;e<r.length;e++){let i=r[e],s=i,l=t.find(e=>e.processedText===i);(l?.loadedRefData||l?.type==="figma")&&(s=(0,a.jsx)("div",{className:eL.inputPreviewRef,...(0,o.G)("input-preview-ref"),children:l.processedText},e)),n.push(s),e<r.length-1&&n.push(" ")}return n}(t,r);return(0,a.jsx)("div",{id:"copilot-chat-textarea-preview",...(0,o.G)("copilot-chat-input-textarea-preview"),"aria-hidden":!0,className:eL.inputPreview,ref:n,role:"presentation",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:eL.token,children:i}),s]}):(0,a.jsx)(a.Fragment,{children:l})})}function eH({isLoading:e}){return(0,a.jsx)(l.N5,{commandId:"copilot-chat:send-message",variant:"invisible",size:"medium",icon:d.PaperAirplaneIcon,"aria-label":"Send now",disabled:e,tooltipDirection:"n"})}function e$(){return(0,a.jsx)(l.N5,{...(0,o.G)("copilot-chat-stop-button"),commandId:"github:cancel",variant:"invisible",size:"medium",icon:d.SquareFillIcon,tooltipDirection:"n",sx:{bg:"danger.subtle",color:"danger.fg",":hover":{bg:"danger.muted"}}})}function eK(e,t,n,r=!1){let a=[],i=/^(?:http:\/\/github\.localhost|https:\/\/github\.com)\/[^/]+\/[^/]+\/(issues|pull|discussions)\/\d+$/,s=/^https:\/\/www\.figma\.com\/.+$/,o=e.split(" ");return{processedText:o.map((e,l)=>{if(a.find(t=>t.originalText===e))return e;let c=t.find(t=>t.originalText===e);if(c)return c.loadedRefData?c.processedText:c.originalText;if(n&&h.W.immersiveFigmaIntegration&&s.test(e)){if(r&&l===o.length-1)return e;let t=e.replace("https://www.","");return a.push({originalText:e,processedText:`${t.length>30?`${t.substring(0,30)}...`:t}`,type:"figma"}),e}if(i.test(e)){if(r&&l===o.length-1)return e;let t=e.split("/"),n=t[t.length-1],i=t[t.length-2],s=t[t.length-3],c=t[t.length-4];a.push({originalText:e,processedText:`@${c}/${s}/${i}/${n}`,type:function(e){switch(e){case"discussions":return"discussion";case"pull":return"pull-request";default:return"issue"}}(i),linkNumber:Number(n),repository:{name:s,owner:c}})}return e}).join(" "),processedRefs:[...t,...a]}}let eV=e=>"issue"===e.type,eG=e=>"pull-request"===e.type,eX=e=>"discussion"===e.type,eJ=e=>"figma"===e.type;try{ez.displayName||(ez.displayName="ChatInput")}catch{}try{eq.displayName||(eq.displayName="TextareaPreview")}catch{}try{eH.displayName||(eH.displayName="SubmitButton")}catch{}try{e$.displayName||(e$.displayName="StopButton")}catch{}},97891:(e,t,n)=>{n.d(t,{h:()=>s});var r=n(74848),a=n(34614);let i={container:"LegalDisclaimer-module__container--f7xb5"},s=()=>(0,r.jsxs)("span",{className:i.container,children:[(0,r.jsx)(a.A,{href:"https://docs.github.com/en/copilot/responsible-use-of-github-copilot-features/responsible-use-of-github-copilot-chat-in-githubcom",inline:!0,muted:!0,children:"Copilot"})," ","uses AI. Check for mistakes."]});try{s.displayName||(s.displayName="LegalDisclaimer")}catch{}},91582:(e,t,n)=>{n.d(t,{Y:()=>j,k:()=>w});var r=n(74848),a=n(15294),i=n(62456),s=n(46988),o=n(38621),l=n(89323),c=n(87330),d=n(8338),u=n(53526),m=n(63867),p=n(74144),h=n(37827),f=n(96540),g=n(47767),x=n(93589),y=n(65615),v=n(7426),b=n(27297);function j({onNewThreadSelected:e,limited:t,type:n="global",selectedModel:a,onModelSelected:i,disabled:o=!1}){let l=(0,y.Pk)(),c=(0,v.b)(),{model:d,availableModels:u}=(0,y.bP)("model","availableModels"),m=(0,y.pn)(e=>"pending"===e.modelsLoading.state),{search:p,pathname:h}=(0,g.zy)(),[j,I]=(0,f.useState)(null),S=function(e){let t=(0,y.pn)(t=>(e?(0,x.B)(t.messages):t.messages).some(e=>e.skillExecutions?.length));return(0,f.useCallback)(e=>t&&(!e.capabilities.supports.tool_calls||e.isThirdParty||"o1-ga"===e.capabilities.family),[t])}("message-retry"===n),N=function(e){let t=(0,y.pn)(t=>(e?(0,x.B)(t.messages):t.messages).some(e=>e.mediaContent?.length)||t.currentReferences.some(e=>"image"===e.type));return(0,f.useCallback)(e=>t&&!e.capabilities.supports.vision,[t])}("message-retry"===n);a||(a=d??b.UB);let A=u??[b.UB];return((0,f.useEffect)(()=>{m&&c.fetchModels()},[c,m]),(0,f.useEffect)(()=>{if("immersive"!==l.mode)return;let e=new URLSearchParams(p).get("model");if(e&&("/copilot"===h||"/copilot/"===h)){if(d.id===e)return;let t=u?.find(t=>t.id===e);t&&(c.selectModel(t,"url"),(0,s.BI)("dotcom_chat.activate",{target:"COPILOT_MODEL_LOADED_FROM_URL",mode:"immersive"}))}},[u]),A.length<2)?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w,{selectedModel:a,models:A,type:n,onModelPicked:e=>{("global"!==n||e.id!==a.id)&&((0,s.BI)("dotcom_chat.activate",{target:"MODEL_PICKER_MODEL_SELECT",mode:"immersive",model:e.id,isUnchanged:e.id===a.id,type:n}),S(e)?I({model:e,command:{action:"requires-new-conversation",reason:"external-content"}}):N(e)?I({model:e,command:{action:"requires-new-conversation",reason:"degraded-image-support"}}):e.policy&&"enabled"!==e.policy.state?I({model:e,command:{action:"requires-policy-approval"}}):i?i(e):c.selectModel(e))},limited:t,disabled:o,variant:"invisible"}),j?.command.action==="requires-new-conversation"&&(0,r.jsx)(R,{model:j.model,reason:j.command.reason,onDismiss:()=>{(0,s.BI)("dotcom_chat.activate",{target:"MODEL_PICKER_DIALOG_REQUIRES_NEW_CONVERSATION_CANCEL",mode:"immersive",model:j.model.id,type:n}),I(null)},onSwitch:async()=>{(0,s.BI)("dotcom_chat.activate",{target:"MODEL_PICKER_DIALOG_REQUIRES_NEW_CONVERSATION_CONFIRM",mode:"immersive",model:j.model.id,type:n}),I(null),await e(),c.selectModel(j.model)}}),j?.command.action==="requires-policy-approval"&&(0,r.jsx)(C,{model:j.model,onDismiss:()=>{(0,s.BI)("dotcom_chat.activate",{target:"MODEL_PICKER_DIALOG_POLICY_CANCEL",mode:"immersive",model:j.model.id,type:n}),I(null)},onConfirm:async()=>{await c.acceptModelPolicy(j.model),c.selectModel(j.model),(0,s.BI)("dotcom_chat.activate",{target:"MODEL_PICKER_DIALOG_POLICY_CONFIRM",mode:"immersive",model:j.model.id,type:n}),I(null)}})]})}function w({selectedModel:e,models:t,onModelPicked:n,limited:a=!1,type:i,disabled:u,variant:m="invisible"}){let p=t.filter(e=>!e.preview),h=t.filter(e=>e.preview),g=new Set(t.map(e=>e.vendor)).size>1,x=t.some(e=>e.isThirdParty),y=a?A:[],v=(0,f.useCallback)(()=>{(0,s.BI)("dotcom_chat.activate",{target:"MODEL_PICKER_OPEN",mode:"immersive",model:e.id,type:i})},[e.id,i]);return(0,r.jsxs)(l.W,{children:["global"===i?(0,r.jsxs)(l.W.Button,{onClick:v,"aria-label":"Switch model",variant:m??"invisible",disabled:u,children:[(0,r.jsx)("span",{className:"sr-only",children:"Model: "}),e.displayName]}):(0,r.jsx)(l.W.Anchor,{onClick:v,"aria-label":"Retry with model",children:(0,r.jsx)(c.K,{variant:"invisible",icon:o.SyncIcon,"aria-label":"Retry",disabled:u,"data-testid":"message-retry-button"})}),(0,r.jsx)(l.W.Overlay,{sx:{width:"var(--overlay-width-small)"},align:"center",children:(0,r.jsxs)(d.l,{selectionVariant:"single",children:["message-retry"===i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(d.l.Item,{onSelect:()=>n(e),children:[(0,r.jsx)(d.l.LeadingVisual,{children:(0,r.jsx)("span",{"data-testid":"dropdown-message-retry-icon",children:(0,r.jsx)(o.SyncIcon,{})})}),"Try again",(0,r.jsx)(d.l.Description,{variant:"block",truncate:!0,children:e.displayName})]},e.id),(0,r.jsx)(d.l.Divider,{})]}),p.length>0&&(0,r.jsxs)(d.l.Group,{children:[(0,r.jsx)(d.l.GroupHeading,{children:"Models"}),p.map(t=>(0,r.jsx)(I,{model:t,selected:t.id===e.id&&"global"===i,onModelPicked:n,hasMultipleVendors:g,hasThirdPartyModel:x},t.id))]}),(h.length>0||y.length>0)&&(0,r.jsxs)(d.l.Group,{children:[(0,r.jsx)(d.l.GroupHeading,{children:"Preview"}),h.map(t=>(0,r.jsx)(I,{model:t,selected:t.id===e.id&&"global"===i,onModelPicked:n,hasMultipleVendors:g,hasThirdPartyModel:x},t.id)),y.map(e=>(0,r.jsxs)(d.l.LinkItem,{href:N,children:[(0,r.jsx)(d.l.LeadingVisual,{children:(0,r.jsx)(S,{model:e})}),e.displayName,(0,r.jsx)(d.l.Description,{variant:"block",truncate:!0,children:e.vendor}),(0,r.jsx)(d.l.TrailingVisual,{children:(0,r.jsx)("div",{className:"fgColor-muted",children:"Upgrade"})})]},e.id))]})]})})]})}function I({model:e,selected:t,onModelPicked:n,hasMultipleVendors:a,hasThirdPartyModel:i}){return(0,r.jsxs)(d.l.Item,{onSelect:()=>n(e),selected:t,children:[(a||i)&&(0,r.jsx)(d.l.LeadingVisual,{children:(0,r.jsx)(S,{model:e})}),e.displayName,(a||i)&&(0,r.jsx)(d.l.Description,{variant:"block",truncate:!0,children:e.vendor})]},e.id)}function R({model:e,onDismiss:t,onSwitch:n,reason:a}){return(0,r.jsxs)(u.K,{title:"Switch model",onClose:e=>"confirm"===e?n():t(),confirmButtonContent:"New conversation",confirmButtonType:"primary",children:["external-content"===a&&(0,r.jsxs)("p",{children:["The ",e.displayName," model currently doesn\u2019t support external context from ongoing conversations. Start a new conversation to chat with this model."]}),"degraded-image-support"===a&&(0,r.jsxs)("p",{children:["The ",e.displayName," model doesn\u2019t support answering questions about images. Start a new conversation without images to chat with this model."]})]})}function C({model:e,onDismiss:t,onConfirm:n}){let[i,s]=(0,f.useState)(null),[o,l]=(0,f.useState)(!1),c=e.policy?.terms??"",d=async()=>{try{l(!0),await n(),s(null)}catch{s("An error occurred while updating the policy")}finally{l(!1)}};return(0,r.jsxs)(p.l,{width:"large",onClose:t,title:`Enable ${e.displayName}`,footerButtons:[{buttonType:"default",content:"Cancel",onClick:t},{buttonType:"primary",content:o?(0,r.jsx)(m.A,{sx:{mx:2},size:"small"}):"Enable",onClick:()=>void d()}],children:[i&&(0,r.jsx)(h.l,{title:"Error",variant:"critical",children:i}),(0,r.jsx)(a.To,{markdown:c})]})}function S({model:e}){return e.logoURL?(0,r.jsx)(i.r,{alt:`${e.vendor} logo`,square:!0,size:18,src:e.logoURL}):(0,r.jsx)(o.CopilotIcon,{})}let N="https://github.com/features/copilot#pricing",A=[{id:"claude-3.7-sonnet-upgrade",displayName:"Claude 3.7 Sonnet",vendor:"Anthropic",logoURL:"/images/modules/marketplace/models/families/anthropic.svg"},{id:"o1-upgrade",displayName:"o1",vendor:"Azure OpenAI",logoURL:"/images/modules/marketplace/models/families/openai.svg"}];try{j.displayName||(j.displayName="ModelPicker")}catch{}try{w.displayName||(w.displayName="ModelPickerDesign")}catch{}try{I.displayName||(I.displayName="ModelListItem")}catch{}try{R.displayName||(R.displayName="NewConversationConfirmationDialog")}catch{}try{C.displayName||(C.displayName="ModelPolicyConfirmationDialog")}catch{}try{S.displayName||(S.displayName="ModelVendorIcon")}catch{}},89401:(e,t,n)=>{n.d(t,{Cb:()=>h,Dq:()=>c,E5:()=>l,Gj:()=>d,UJ:()=>g,cB:()=>m,f1:()=>u,hl:()=>f,zc:()=>p});var r=n(74848),a=n(16255),i=n(75177),s=n(89323),o=n(96540);let l="copilotChatMenuPortalRoot",c="copilotChatMessagesMenuPortalRoot",d="copilotChatPortalRoot",u="copilotChatTopicPickerPortalRoot",m=()=>{let e=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(0,a.c)(e.current,d)},[]),(0,r.jsx)(i.A,{ref:e,sx:{position:"absolute",top:0,right:0,zIndex:100}})},p=()=>{let e=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(0,a.c)(e.current,l)},[]),(0,r.jsx)(i.A,{ref:e,sx:{position:"absolute",top:0,right:0}})},h=()=>{let e=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(0,a.c)(e.current,c)},[]),(0,r.jsx)("div",{ref:e})},f=()=>{let e=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(0,a.c)(e.current,u)},[]),(0,r.jsx)("div",{ref:e})},g=({children:e,portalContainerName:t,...n})=>{let[a,i]=(0,o.useState)(()=>"undefined"!=typeof document);return((0,o.useEffect)(()=>i(!0),[]),a)?(0,r.jsx)(s.W.Overlay,{...n,portalContainerName:t||l,children:e}):null};try{m.displayName||(m.displayName="ChatPortalContainer")}catch{}try{p.displayName||(p.displayName="MenuPortalContainer")}catch{}try{h.displayName||(h.displayName="MessagesPortalContainer")}catch{}try{f.displayName||(f.displayName="TopicPickerPortalContainer")}catch{}try{g.displayName||(g.displayName="ActionMenuOverlay")}catch{}},60068:(e,t,n)=>{n.d(t,{B:()=>x,a:()=>y});var r,a=n(74848),i=n(91295),s=n(38621),o=n(87330),l=n(63867),c=n(20053),d=n(96540),u=n(82610),m=n(65615),p=n(7426),h=n(54006),f=n(90591);let g={referenceToken:"ReferenceToken-module__referenceToken--MoDht",small:"ReferenceToken-module__small--LxJV_",name:"ReferenceToken-module__name--Wq2Bs",removeButton:"ReferenceToken-module__removeButton--BIbYP",icon:"ReferenceToken-module__icon--WJse5",openIcon:"ReferenceToken-module__openIcon--LVVWZ",closedIcon:"ReferenceToken-module__closedIcon--qYsTG",pullRequestClosedIcon:"ReferenceToken-module__pullRequestClosedIcon--ivG0w",pullRequestMergedIcon:"ReferenceToken-module__pullRequestMergedIcon--S1IFs",figmaIconOuter:"ReferenceToken-module__figmaIconOuter--PpoUe",figmaIcon:"ReferenceToken-module__figmaIcon--x5K98"},x=(0,d.forwardRef)(function({reference:e,onClick:t,onRemove:n,size:r},i){let l=(0,p.b)(),h=(0,m.pn)(e=>"immersive"===e.mode),f=y(e,(0,u.P)((0,m.A3)("currentTopic"))),x=(0,d.useId)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("a",{href:(0,u.JP)(e),className:(0,c.$)(g.referenceToken,"small"===r&&g.small),onKeyDown:e=>{n&&("Delete"===e.key||"Backspace"===e.key)&&(e.preventDefault(),n())},onClick:n=>{t&&(t(n,e),n.defaultPrevented)||h||(("issue"===e.type||"pull-request"===e.type||"discussion"===e.type)&&(window.open(e.url,"_blank"),self.focus()),["repository","folder","docset","third-party","image","issue","pull-request"].includes(e.type)||(n.preventDefault(),l.selectReference(e)))},ref:i,"aria-describedby":n&&x,children:[f&&(0,a.jsx)(f,{size:"small",className:(0,c.$)(g.icon,f===s.IssueOpenedIcon&&g.openIcon,f===s.GitPullRequestIcon&&g.openIcon,f===s.IssueClosedIcon&&g.closedIcon,f===s.GitPullRequestClosedIcon&&g.pullRequestClosedIcon,f===s.GitMergeIcon&&g.pullRequestMergedIcon)}),(0,a.jsx)("span",{className:g.name,children:(0,u.z$)(e)}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.K,{tabIndex:-1,"aria-hidden":!0,size:r,icon:s.XIcon,"aria-label":"Remove",onClick:e=>{e.stopPropagation(),e.preventDefault(),n()},tooltipDirection:"n",variant:"invisible",className:g.removeButton}),(0,a.jsx)("span",{hidden:!0,id:x,children:"press backspace or delete to remove"})]})]})})});function y(e,t){switch(e.type){case"figma":return v;case"file":return s.FileIcon;case"folder":return s.FileDirectoryFillIcon;case"file-diff":return s.FileDiffIcon;case"snippet":return t&&e.languageName&&h.Y.has(e.languageName)?s.BookIcon:s.CodeIcon;case"repository":return s.RepoIcon;case"symbol":return s.CodeSquareIcon;case"docset":return s.BookIcon;case"commit":return s.GitCommitIcon;case"pull-request":return function(e){if("pull-request"===e.type){if(e.draft&&"open"===e.state)return s.GitPullRequestDraftIcon;switch(e.state){case"open":default:return s.GitPullRequestIcon;case"closed":return s.GitPullRequestClosedIcon;case"merged":return s.GitMergeIcon}}}(e);case"repo-instructions":case"org-instructions":return s.NoteIcon;case"image":return e.attachment.isLoaded?s.ImageIcon:l.A;case"issue":return function(e){if("issue"===e.type)switch(e.state){case"open":default:return s.IssueOpenedIcon;case"closed":return s.IssueClosedIcon;case"not_planned":return s.SkipIcon}}(e);case"discussion":return s.CommentDiscussionIcon;case"web-search-result":return function(e){if("web-search-result"===e.type)return"bing_search"===e.reference_type?i._:s.GlobeIcon}(e);default:return}}function v(){return(0,a.jsx)("div",{className:g.figmaIconOuter,children:(0,a.jsx)(f._,{className:g.figmaIcon})})}try{x.displayName||(x.displayName="ReferenceToken")}catch{}try{(r=Icon).displayName||(r.displayName="Icon")}catch{}try{v.displayName||(v.displayName="StylizedFigmaIcon")}catch{}},59010:(e,t,n)=>{n.d(t,{W:()=>s});var r=n(74848),a=n(62456),i=n(8338);function s({onSelect:e,repo:t,selected:n,trailingVisualComponent:s}){let{databaseId:o,isInOrganization:l,nwo:c,ownerAvatarUrl:d}=t;return(0,r.jsxs)(i.l.Item,{onSelect:()=>e(o),selected:n,children:[(0,r.jsx)(i.l.LeadingVisual,{children:(0,r.jsx)(a.r,{src:d,square:l,size:16})}),c,s&&(0,r.jsx)(i.l.TrailingVisual,{children:s})]},c)}try{s.displayName||(s.displayName="RepositoryListItem")}catch{}},90591:(e,t,n)=>{n.d(t,{_:()=>a});var r=n(74848);function a({className:e,...t}){return(0,r.jsxs)("svg",{"aria-label":"Figma logo",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,...t,children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_216_3161)",children:[(0,r.jsx)("path",{d:"M7.99837 7.99967C7.99837 6.52683 9.1922 5.33301 10.665 5.33301C12.1379 5.33301 13.3317 6.52683 13.3317 7.99967C13.3317 9.47252 12.1379 10.6663 10.665 10.6663C9.1922 10.6663 7.99837 9.47252 7.99837 7.99967Z",fill:"#1ABCFE"}),(0,r.jsx)("path",{d:"M2.66504 13.3337C2.66504 11.8608 3.85886 10.667 5.33171 10.667H7.99837V13.3337C7.99837 14.8065 6.80455 16.0003 5.33171 16.0003C3.85886 16.0003 2.66504 14.8065 2.66504 13.3337Z",fill:"#0ACF83"}),(0,r.jsx)("path",{d:"M7.99837 0V5.33333H10.665C12.1379 5.33333 13.3317 4.13951 13.3317 2.66667C13.3317 1.19382 12.1379 0 10.665 0H7.99837Z",fill:"#FF7262"}),(0,r.jsx)("path",{d:"M2.665 2.66667C2.665 4.13951 3.85883 5.33333 5.33167 5.33333H7.99833V0H5.33167C3.85883 0 2.665 1.19382 2.665 2.66667Z",fill:"#F24E1E"}),(0,r.jsx)("path",{d:"M2.66504 7.99967C2.66504 9.47252 3.85886 10.6663 5.33171 10.6663H7.99837V5.33301H5.33171C3.85886 5.33301 2.66504 6.52683 2.66504 7.99967Z",fill:"#A259FF"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_216_3161",children:(0,r.jsx)("rect",{width:"10.6667",height:"16",fill:"white",transform:"translate(2.665)"})})})]})}try{a.displayName||(a.displayName="FigmaIcon")}catch{}},16184:(e,t,n)=>{n.d(t,{O:()=>R});var r=n(74848),a=n(38621),i=n(75177),s=n(84217),o=n(87330),l=n(55847),c=n(8338),d=n(63867),u=n(30729),m=n(96540);function p({children:e}){return(0,r.jsx)(i.A,{sx:{overflow:"auto",maxHeight:"calc(100dvh - 64px - 52px)"},children:(0,r.jsx)(i.A,{sx:{overflow:"hidden",backgroundColor:"canvas.default"},children:(0,r.jsx)(i.A,{sx:{display:"flex",flexDirection:"column"},children:e})})})}function h({children:e,onDismiss:t}){return(0,r.jsxs)(s.A,{as:"h3",sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:"16px",fontSize:1},children:[(0,r.jsx)(i.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",minWidth:0,"@media screen and (max-width: 768px)":{maxWidth:"80%"}},children:e}),t&&(0,r.jsx)(o.K,{unsafeDisableTooltip:!0,"aria-label":"Dismiss",icon:a.XIcon,onClick:t,variant:"invisible",sx:{flexShrink:0}})]})}function f({children:e}){return(0,r.jsx)(i.A,{sx:{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))",borderTop:"1px solid var(--borderColor-default, var(--color-border-default))",backgroundColor:"canvas.subtle",px:3,py:2},children:e})}function g({children:e,title:t,initiallyOpen:n}){let[i,s]=(0,m.useState)(n??!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.Q,{onClick:()=>s(e=>!e),sx:{borderRadius:0,backgroundColor:"canvas.default",border:"none",borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))",'[data-component="buttonContent"]':{justifyContent:"start"}},children:[(0,r.jsx)(u.A,{icon:i?a.ChevronDownIcon:a.ChevronRightIcon,sx:{mr:2}}),t]}),i&&e]})}function x({children:e}){return(0,r.jsx)(i.A,{sx:{padding:3},children:e})}function y({direction:e,onExpand:t}){return(0,r.jsx)(l.Q,{onClick:t,sx:{borderRadius:0,backgroundColor:"canvas.default",border:"none",px:3,py:2,width:"100%",fontSize:0,fontWeight:"normal",color:"fg.muted",'[data-component="buttonContent"]':{justifyContent:"start"},..."above"===e?{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))"}:{borderTop:"1px solid var(--borderColor-default, var(--color-border-default))"}},children:(0,r.jsxs)(i.A,{sx:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(u.A,{icon:"below"===e?a.FoldDownIcon:a.FoldUpIcon,sx:{mr:2}}),"Show content ",e]})})}function v({children:e}){return(0,r.jsx)(c.l,{children:(0,r.jsxs)(c.l.Group,{children:[(0,r.jsx)(c.l.GroupHeading,{as:"h3",children:"Reference details"}),e]})})}function b({children:e,href:t,icon:n}){return(0,r.jsxs)(c.l.LinkItem,{href:t,children:[(0,r.jsx)(c.l.LeadingVisual,{children:(0,r.jsx)(u.A,{icon:n})}),e]})}function j(){return(0,r.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",m:"auto",p:3},children:[(0,r.jsx)(d.A,{sx:{mb:2}}),(0,r.jsx)("div",{children:"Loading..."})]})}function w(){return(0,r.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,r.jsx)(i.A,{sx:{color:"danger.fg",fontWeight:"bold"},children:"Failed to load reference details"})})}function I({children:e,detailsError:t,detailsLoading:n}){return t?(0,r.jsx)(w,{}):n?(0,r.jsx)(j,{}):(0,r.jsx)(r.Fragment,{children:e})}let R={Frame:p,Header:h,Body:I,Content:x,CollapsibleSubsection:g,ContentExpander:y,Details:v,DetailLink:b,SectionDivider:f};try{p.displayName||(p.displayName="Frame")}catch{}try{h.displayName||(h.displayName="Header")}catch{}try{f.displayName||(f.displayName="SectionDivider")}catch{}try{g.displayName||(g.displayName="CollapsibleSubsection")}catch{}try{x.displayName||(x.displayName="Content")}catch{}try{y.displayName||(y.displayName="ContentExpander")}catch{}try{v.displayName||(v.displayName="Details")}catch{}try{b.displayName||(b.displayName="DetailLink")}catch{}try{j.displayName||(j.displayName="Loading")}catch{}try{w.displayName||(w.displayName="Error")}catch{}try{I.displayName||(I.displayName="Body")}catch{}},91295:(e,t,n)=>{n.d(t,{_:()=>d,I:()=>c});var r=n(74848),a=n(75177),i=n(52464),s=n(34614),o=n(16184);let l={"bing-icon":"WebSearchReferencePreview-module__bing-icon--kFZ4I"};function c({reference:e,onDismiss:t}){return(0,r.jsxs)(o.O.Frame,{children:[(0,r.jsx)(o.O.Header,{onDismiss:t,children:(0,r.jsxs)(a.A,{sx:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(d,{}),(0,r.jsxs)(i.A,{sx:{fontSize:0,fontWeight:400,color:"fg.muted"},children:[(0,r.jsxs)(i.A,{sx:{fontSize:1,fontWeight:600,color:"fg.default"},children:[e.results.length," ",1===e.results.length?" result ":" results "]}),"from Bing search."]})]})}),(0,r.jsx)(o.O.Body,{detailsError:!1,detailsLoading:!1,children:(0,r.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",px:3,gap:3,pb:3},children:[e.results.map((e,t)=>(0,r.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",gap:1,border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"6px",padding:3},children:[(0,r.jsx)(s.A,{sx:{fontWeight:600,fontSize:2},href:e.url,rel:"nofollow",children:e.title}),(0,r.jsx)("div",{children:e.excerpt}),(0,r.jsx)(a.A,{sx:{fontSize:0,color:"fg.muted"},children:e.url})]},t)),(0,r.jsx)(i.A,{sx:{fontSize:0,fontWeight:400},children:(0,r.jsx)(s.A,{href:"https://privacy.microsoft.com/en-us/privacystatement",rel:"nofollow",target:"_blank",children:"Microsoft Privacy Statement"})})]})})]})}let d=()=>(0,r.jsx)("div",{className:l["bing-icon"]});try{c.displayName||(c.displayName="WebSearchReferencePreview")}catch{}try{d.displayName||(d.displayName="BingIcon")}catch{}},41980:(e,t,n)=>{n.d(t,{Gy:()=>i,LB:()=>u,lm:()=>l,nn:()=>m});var r=n(74848),a=n(96540);let i={small:1,medium:544,large:768,xlarge:1012,xxlarge:1280,xxxlarge:1350,xxxxlarge:1440},s=[i.xxxxlarge,i.xxxlarge,i.xxlarge,i.xlarge,i.large,i.medium,i.small],o=a.createContext({screenSize:i.small});function l(){return a.useContext(o)}function c(e){let t=null,n=new ResizeObserver(()=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(e)});return n.observe(document.documentElement),()=>{t&&window.cancelAnimationFrame(t),n.disconnect()}}function d(){return m(window.innerWidth)}function u({children:e,initialValue:t=i.small}){let n=(0,a.useSyncExternalStore)(c,d,(0,a.useCallback)(()=>t,[t])),s=(0,a.useMemo)(()=>({screenSize:n}),[n]);return(0,r.jsx)(o.Provider,{value:s,children:e})}function m(e){for(let t of s)if(e>=t)return t;return i.small}try{o.displayName||(o.displayName="ScreenContext")}catch{}try{u.displayName||(u.displayName="ScreenSizeProvider")}catch{}},70642:(e,t,n)=>{n.d(t,{x:()=>m});var r=n(74848),a=n(38621),i=n(75177),s=n(65481),o=n(34614),l=n(89323),c=n(8338),d=n(30729),u=n(47767);function m({portalContainerName:e,protectedOrgs:t,redirectURI:n,isDisplayedInSelectPanel:l,sx:c}){let m=(0,u.zy)();if(!t||0===t.length)return null;let f=(0,r.jsx)("b",{children:t.slice(0,3).join(", ")});return 2===t.length&&(f=(0,r.jsxs)("span",{children:[(0,r.jsx)("b",{children:t[0]})," and ",(0,r.jsx)("b",{children:t[1]})]})),3===t.length&&(f=(0,r.jsxs)("span",{children:[(0,r.jsx)("b",{children:t.slice(0,2).join(", ")}),", and ",(0,r.jsx)("b",{children:t[2]})]})),(0,r.jsx)(i.A,{sx:c,"data-testid":"sso-banner",children:(0,r.jsx)(i.A,{sx:{fontSize:1},children:(0,r.jsx)("section",{"aria-label":"Single sign on information",children:(0,r.jsx)(s.A,{sx:{p:3,borderRadius:l?0:2,borderWidth:l?"1px 0":1,borderStyle:"solid",borderColor:"accent.muted",fontSize:1},children:1===t.length?(0,r.jsxs)("div",{children:[(0,r.jsx)(d.A,{icon:a.ShieldLockIcon}),(0,r.jsx)(o.A,{inline:!0,href:`/orgs/${t[0]}/sso?return_to=${h({location:m,redirectURI:n})}`,children:"Single sign-on"}),"\xa0to see results in the ",(0,r.jsx)("b",{children:t[0]})," organization."]}):(0,r.jsxs)(i.A,{sx:{display:"flex",alignItems:"baseline",gap:2,"& svg":{marginRight:"0 !important"}},children:[(0,r.jsx)(d.A,{sx:{position:"relative",top:"3px"},icon:a.ShieldLockIcon}),(0,r.jsxs)(i.A,{sx:{display:"flex",alignItems:"baseline",gap:[0,2],flexWrap:["wrap","nowrap"],flexGrow:1},children:[(0,r.jsxs)(i.A,{as:"p",sx:{marginBottom:0,flexGrow:1},children:["Single sign on to see results in the ",f," ",t.length>3?`and ${t.length-3} other `:"",t.length>1?"organizations":"organization","."]}),(0,r.jsx)("div",{children:(0,r.jsx)(p,{portalContainerName:e,protectedOrgs:t,redirectURI:n})})]})]})})})})})}function p({portalContainerName:e,protectedOrgs:t,redirectURI:n}){let a=(0,u.zy)();return(0,r.jsxs)(l.W,{children:[(0,r.jsx)(l.W.Button,{size:"small",children:"Select an organization"}),(0,r.jsx)(l.W.Overlay,{portalContainerName:e,children:(0,r.jsx)(c.l,{children:t.map(e=>(0,r.jsx)(c.l.Item,{onSelect:()=>window.location.href=`/orgs/${e}/sso?return_to=${h({location:a,redirectURI:n})}`,children:e},`org-${e}`))})})]})}function h({location:e,redirectURI:t}){return encodeURIComponent(t?t(e):e.pathname+e.search+e.hash)}try{m.displayName||(m.displayName="SingleSignOnBanner")}catch{}try{p.displayName||(p.displayName="SingleSignOnButton")}catch{}}}]);
//# sourceMappingURL=ui_packages_copilot-chat_components_ChatInput_tsx-ui_packages_copilot-chat_components_LegalDi-cbec1d-fea603ac2bc3.js.map